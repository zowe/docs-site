# Zowe v3.4 – API ML Installation and Configuration Checklist 

Zowe v3.4 introduces a significant architectural shift with the single-service deployment option for the API Mediation Layer (API ML). Unlike previous Zowe versions (such as v2.18 and early v3.0 releases) where the API Gateway, Discovery Service, and other core API ML components are deployed as separate microservices, the single-service deployment consolidates these essential functionalities into a single, unified Spring Boot application. 

This single-server architecture offers substantial benefits over multi-service deployments by simplifying installation and configuration, reducing the number of processes to manage, and lowering internal communication overhead. The result is a more streamlined, easier-to-maintain, and potentially more performant API ML environment.

## Preparing for Installation
| Step | Task | Applicable Link | Results | Required Role |
| :--- | :-------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------ | :--------------------------------------- |
| 1 | Verify Java 17+, z/OS 2.4+, and Zowe 3.3 runtime prerequisites. | [Addressing Zowe server prerequisites](https://docs.zowe.org/stable/user-guide/install-nodejs-zos/) | Java 17, z/OS 2.4+, and Zowe 3.3 prerequisites confirmed; all system requirements met. | System Programmer / Zowe Administrator |
| 2 | Choose deployment type: **single-service** or **multi-component**. | [Zowe deployment types](https://docs.zowe.org/stable/install-zos/install-zowe-zos.html#zowe-deployment-types) | Single-service deployment chosen for consolidated API ML. | Zowe Administrator |
| 3 | Update firewall and port settings if using single-service mode. | [Component ports](https://docs.zowe.org/stable/user-guide/address-network-requirements/#component-ports) | Firewall rules updated for single-port operation; required ports confirmed open and available. | Network Administrator / Zowe Administrator |

## Installing the Zowe z/OS Runtime
| Step | Task | Applicable Link | Results | Required Role |
| :--- | :-------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------- | :--------------------------------------- |
| 4 | Install Zowe v3.4 using Zowe Server Install Wizard, Convenience Build, SMP/E build, or Portable Software Instance. | [Install Zowe on z/OS](https://docs.zowe.org/stable/install-zos/install-zowe-zos.html) | Zowe v3.4 convenience build package downloaded and extracted to `/usr/local/zowe/runtime`. | System Programmer / Zowe Administrator |
| 5 | Run `zwe install` or `zwe generate --dry-run`. | [zwe install command](https://docs.zowe.org/stable/install-zos/install-zowe-convenience-build.html#installation-steps) | `zwe install` executed, Zowe runtime deployed; `instance.env` and `zowe.yaml` generated. | System Programmer / Zowe Administrator |
| 6 | Define API ML settings under `components.apiml` in `zowe.yaml`. | [API Mediation Layer configuration](https://docs.zowe.org/stable/user-guide/configuration-file-reference.html#api-mediation-layer-configuration) | `zowe.yaml` updated with consolidated `components.apiml` settings for Gateway, Discovery, and Catalog. | Zowe Administrator |

## Configuring API ML with a z/OSMF Workflow
| Step | Task | Applicable Link | Results | Required Role |
| :--- | :----------------------------------------------------- | :------------------------------------------------------------------------------------------------------------ | :----------------------------------------------------------------------------------- | :--------------------------------------- |
| 7 | Use the Stand-alone Zowe API ML Configuration workflow. | [Configuring API ML with z/OSMF Workflow](https://docs.zowe.org/stable/user-guide/configure-apiml-zosmf-workflow.html) | Zowe API ML Configuration z/OSMF workflow imported and initiated. | System Programmer / Zowe Administrator |
| 8 | We recommend you select “Single-service deployment” as your deployment method. | [Define workflow variables in z/OSMF](https://docs.zowe.org/stable/user-guide/configure-apiml-zosmf-workflow.html#define-workflow-variables) | "Single-service deployment" selected as the deployment method in the z/OSMF workflow. | Zowe Administrator |
| 9 | Specify trusted proxies and forward-header parameters. | [Configure trusted proxies](https://docs.zowe.org/stable/user-guide/configure-apiml-zosmf-workflow.html#configure-trusted-proxies) | Trusted proxy and forward-header parameters configured as required during workflow execution. | Network Administrator / Zowe Administrator |


###  Configuring API ML Security & Certificates on z/OS
| Step | Task | Applicable Link | Results | Time Estimate | Required Role |
| :--- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :--------------------------------------- |
| 1 | Identify and reserve necessary network ports for the API Gateway, Discovery Service, and API Catalog, noting the consolidation if using a modulith deployment. | [Zowe default ports](https://docs.zowe.org/stable/user-guide/configure-zos-system.html#zowe-default-ports) | Required ports (e.g., 7551 for a modulith deployment, or individual ports for multi-component) are identified and confirmed as available and open through any firewalls. | N/A | Network Administrator / Zowe Administrator |
| 2 | Run `zwe init security` to create SAF security profiles and ensure that the Zowe runtime user (typically `ZWESVUSR`) has permissions to utilize Zowe resources. | [Generate Zowe security configurations](https://docs.zowe.org/stable/user-guide/initialize-zos-system.html#generate-zowe-security-configurations) | SAF profiles for Zowe and its components (including API ML) are created, and `ZWESVUSR` is defined with necessary permissions for Zowe started tasks and USS access. | N/A | Security Administrator / Zowe Administrator |
| 3 | Configure Zowe security group IDs for API ML users and services, ensuring proper access control. | [Assigning security permissions to users](https://docs.zowe.org/stable/user-guide/assign-security-permissions-to-users.html) | Zowe security group IDs are assigned to relevant API ML users and services, adhering to organizational security policies. | N/A | Security Administrator |
| 4 | **Understand Zowe Certificate Requirements:** Review the basics of Zowe's certificate architecture, including the need for TLS/SSL and mTLS for secure communication between components, especially in the context of modulith. | [Configuring Zowe certificates](https://docs.zowe.org/stable/user-guide/configure-certificates.html) | Clear understanding of Zowe's certificate requirements, the types of certificates needed (server, CA), and their role in securing the API ML. | N/A | Zowe Administrator / Security Administrator |
| 5 | **Create or import security certificates** for TLS/SSL communication using one of the following methods: <br /> **Option 1:** Use the `zwe certificate` command (or the `zowe-certificate-manager.sh` script) to generate self-signed certificates or import CA-signed certificates into a Zowe-managed keystore. <br /> **Option 2:** Manually create/import certificates (e.g., via RACF `RACDCERT` or Java `keytool`) and configure them externally. | [Using the Zowe certificate management utility](https://docs.zowe.org/stable/user-guide/configure-certificates.html#using-the-zowe-certificate-management-utility) <br /> [Configuring certificates in zowe.yaml](https://docs.zowe.org/stable/user-guide/configure-certificates.html#configuring-certificates-in-zowe.yaml) | A server certificate and its private key are generated or imported, ready for use by the API Gateway, Discovery Service, and other Zowe services. Trusted CA certificates are also established. | 2 hours | Security Administrator / Zowe Administrator |
| 6 | Grant the Zowe runtime user (e.g., `ZWESVUSR`) appropriate access to the SAF keyring or external keystore containing Zowe's certificates. | [Granting Zowe user access to certificates and keyrings](https://docs.zowe.org/stable/user-guide/configure-certificates.html#granting-the-zowe-started-task-user-access-to-certificates-and-keyrings) | `ZWESVUSR` has `READ` access to the `ZoweKeyring` (or other specified keystore) and its associated certificates, enabling Zowe components to load and use them. | N/A | Security Administrator |
| 7 | Update the `zowe.yaml` configuration file with the certificate locations and keyring names, including any specific modulith TLS settings. | [Certificate configuration parameters](https://docs.zowe.org/stable/user-guide/configuration-file-reference.html#certificate-configuration-parameters) | `zowe.yaml` is updated to correctly reference the certificate keystore (e.g., `safkeyring://ZWESVUSR/ZoweKeyring`) and other TLS/SSL settings for the API ML components. | N/A | Zowe Administrator |
 


## Configuring High Availability
| Step | Task | Applicable Link | Results | Required Role |
| :--- | :-------------------------------------------------------- | :------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------- | :--------------------------------------- |
| 17 | Configure HA mode by deploying multiple independent Zowe server component instances, ideally on different LPARs. | [High availability overview](https://docs.zowe.org/stable/admin/high-availability/overview.html) | Multiple Zowe single-service instances deployed on separate LPARs, ensuring redundancy. | Zowe Administrator / System Programmer |
| 18 | Define Eureka timeouts (`connectTimeout`, `readTimeout`). | [Eureka configuration](https://docs.zowe.org/stable/user-guide/configuration-file-reference.html#eureka-configuration) | Eureka `connectTimeout` and `readTimeout` defined in `zowe.yaml` for robust discovery. | Zowe Administrator |
| 19 | For single-service, enable HA through external clustering. | [Load balancing configuration](https://docs.zowe.org/stable/admin/high-availability/load-balancing-configuration.html) | External load balancer (e.g., Sysplex Distributor) configured for Gateway endpoints. | Network Administrator |

## Starting and Stopping Zowe
| Step | Task | Applicable Link | Results | Required Role |
| :--- | :---------------------------------------------------- | :------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------- | :--------------------------------------- |
| 20 | Start Zowe with `zwe start apiml` or `zwe start all`. | [Starting and stopping a Zowe instance](https://docs.zowe.org/stable/manage/managing-zowe-instances.html#starting-and-stopping-a-zowe-instance) | Zowe started successfully; all API ML services (Gateway, Discovery) show as active. | Zowe Administrator / System Programmer |
| 21 | Stop Zowe with `zwe stop apiml` or `zwe stop all`. | [Starting and stopping a Zowe instance](https://docs.zowe.org/stable/manage/managing-zowe-instances.html#starting-and-stopping-a-zowe-instance) | Zowe stopped successfully; JES logs confirm clean shutdown of all components. | Zowe Administrator / System Programmer |

## Verifying Installation
| Step | Task | Applicable Link | Results | Required Role |
| :--- | :----------------------------------------------- | :----------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------- | :--------------------------------------- |
| 22 | Access API Catalog and verify registered APIs. | [Verify Zowe API Mediation Layer is up and running](https://docs.zowe.org/stable/user-guide/installandconfig.html#verify-zowe-api-mediation-layer-is-up-and-running) | API Catalog UI loaded, showing expected core and onboarded APIs registered via the Spring Gateway. | Zowe Administrator / Application Developer |
| 23 | Confirm “single-service mode enabled” in Gateway logs. | [Zowe API Mediation Layer logs](https://docs.zowe.org/stable/troubleshoot/troubleshoot-apiml.html#zowe-api-mediation-layer-logs) | Gateway logs show clear indication of "single-service mode enabled" upon startup. | Zowe Administrator |
| 24 | Test proxy header forwarding using REST client. | [Configure trusted proxies](https://docs.zowe.org/stable/user-guide/configure-apiml-zosmf-workflow.html#configure-trusted-proxies) | REST client requests through Gateway confirm `X-Forwarded-*` headers are correctly processed. | Application Developer / Zowe Administrator | 


