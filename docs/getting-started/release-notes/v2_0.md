# Version 2.0.0 (April 2022)

Welcome to the Version 2.0.0 release of Zowe! 

Version 2.0 introduced breaking changes and a number of new features. 

- If you are upgrading from V1 to V2, review the [Breaking changes](#breaking-changes) first. 
- See [New features and enhancements](#new-features-and-enhancements) for a full list of changesto the functionality. 
- See [Bug fixes](#bug-fixes) for a list of V1 issues addressed in this release. 
- See [Changes to Zowe Conformance Criteria](#changes-to-zowe-conformance-criteria) for changes to the V2 Conformance Criteria.

**Download v2.0.0 build:** Want to try new features as soon as possible? You can download the V2.0.0 build from [Zowe.org](https://www.zowe.org/download.html).

**v2 office hours videos**: Zowe held a series of v2 LTS office hours for extenders and consumers to introduce all the V2 changes. Watch the [videos](../zowe-office-hours.md) to learn more about the new features.

## Breaking changes

### Zowe installation

* You must pass `-ppx` when you unpax the Zowe convenience build to preserve extended file attributes.
* All utility scripts, like `zowe-install.sh`, `zowe-install-xmem.sh`, `zowe-install-proc.sh`, `validate-directory-is-accessible.sh`, and so on, are removed and migrated to the new `zwe` server command format.
* If you rely on some of the scripts, please find the alternative new `zwe` command or shell library functions.
* `ZWESVSTC` is removed and `ZWESLSTC` will replace it to start Zowe.
* `instance.env` is deprecated and replaced by `zowe.yml`.
* In V2, you use the `P` command to terminate Zowe instead of the `C` cancel command.
* Zowe now allows fine-grained customization of log, workspace, and configuration directories. By default, these directories remain grouped under an `instance` directory (same as Zowe v1).
* Environment variables are reorganized to better describe itself. All `zowe.yaml` configuration entries will be automatically converted to environment variables for easy consumption. Check with the community what the new alternative variable names are.
* During Zowe configuration, redundant `ip` fields will be removed or consolidated in favor of `hostname` or `domains`.
* Component or extension manifest is mandatory. You must use the `zwe components install` command to install the extension.

### API Mediation Layer
  
* Removed the support for the old path pattern ([#1770](https://github.com/zowe/api-layer/issues/1770)). This includes the changes to the endpoints used in ZAAS client. If your application uses ZAAS client, please verify whether the configuration properties use the new path pattern (`/gateway/api/v1` instead of `/api/v1/gateway`).
* Removed the support for different authentication schemas for different instances of service ([#1051](https://github.com/zowe/api-layer/issues/1051)).

### Zowe Application Framework

Some configuration, such as port and IP values, are different by default in V2  but can be reconfigured to old values. However, some application framework extensions may not work in V2 without enhancements.

* Consolidation of Web Explorer Servers: Bookmarks to USS, MVS, JES explorers will be broken due to URL change.
* `loopback routing` disabled: Loopback routing alternative may not be 100% compatible. It can be disabled via config parameter `node.internalRouting=false`.
* `server.json` removed: The mandatory `zowe.yaml` can contain the same content as `server.json` within the objects `components.app-server` and `components.zss`.
* Scripts that wrote to `server.json` will be broken. You must adapt them to write to `zowe.yaml` instead.
* Incompatible desktop library version upgrades: Angular 12, corejs, and typescript were updated in the Zowe Desktop, and non-iframe plugins that depend on them may break.
* ZSS cookie name change: ZSS cookie name now includes a suffix of either port name or HA/FT ID to distinguish between unrelated ZSS servers.
* Internationalization that use Angular has changed from 6 (`TranslationService`  for example) to 12 (`L10TranslationService` for example). For help in updating your Zowe Desktop applications to match new internationalization usage, you can see [Sample Angular App example](https://github.com/zowe/sample-angular-app/pull/69/files).

### Zowe CLI

* Breaking changes for Zowe CLI end users:

    * `zowe config` no longer manages app settings (Imperative and CLI)
    * `fail-on-error` default changed to true for `zowe plugins validate` (Imperative and CLI)
    * Default Imperative and CLI log level changed from DEBUG to WARN (Imperative and CLI), which potentially changes troubleshooting steps for providing information to support.

* Breaking changes that could prevent a V1 plug-in or SDK from working in V2

    * CLI package should be removed as a plug-in peer dep (Imperative)
    * `AbstractRestClient.mDecode` defaults to true so any plug-in with custom RestClient implementation that adds gzip decompression may break
    * The return value for `PluginManagementFacility.requirePluginModuleCallback` changed. Application and plug-in developers requiring a module from a plug-in's relative path using the `requirePluginModuleCallback` function no longer need to provide the plug-in name in a separate variable `this.pluginNmForUseInCallback = pluginName` before binding the class `this.requirePluginModuleCallback.bind(this)`. Instead they can call `this.requirePluginModuleCallback(pluginName)`.
       * Previously in V1:
        ```
        this.pluginNmForUseInCallback = pluginName
        ConfigurationLoader.load(null,pkgJsonData,this.requirePluginModuleCallback.bind(this))
        ```
       * In V2:
        ```
        pluginConfig = ConfigurationLoader.load(null,pkgJsonData,this.requirePluginModuleCallback(pluginName))
        ```
* Breaking changes for Zowe CLI and Imperative plug-in developers
   
    These changes only impact early adopters of @next as these are breaking changes made during the technical preview validation phase. Thanks to the community for the feedback.

    * `tokenType` and `tokenValue` were combined into `authToken`, which later was reverted (Imperative and CLI) 
    * Options in `zowe config` group are renamed: `--user` is renamed to `--user-config`, and `--global` to `--global-config`.
    * `Zowe.schema.json` format changed a few times (version 2, version 3): `ConfigSchemas.loadProfileSchemas` is changed to `ConfigSchemas.loadSchema`
    * `Config.set` no longer coerces string values to other types unless `parseString = true` which might impact the SDK instead of CLI plug-ins.


## New features and enhancements

### Zowe installation

* Introduced a new server command `zwe` to balance between simplification and flexibility on installation and configuration.
   * Almost all Zowe utility scripts in V1 are consolidated into new `zwe` server command. This new command defines consistent help messages, logging options, and so on. See the [ZWE Command Reference](../appendix/zwe_server_command_reference) for more information.
   * Provides shell function library to help extensions to achieve common tasks. For example, execute TSO command, operator command, submit job and check job completion, and so on.
   * Keep away from commands/functions marked as experimental and internal.
* Installation / Configuration changes
   * During installation, no new runtime directory will be created.
   * A `zowe.yaml` file can be used to centralize all configuration options. This configuration is compatible with all Zowe use cases (including high availability and containerization).
   * For almost all Zowe configuration steps, an automation option `zwe init` command is provided. You can still choose to run all steps one by one.
   * Provides the `--security-dry-run` mode that allows you to generate security commands and pass along to your system admin.
   * You can run all steps from USS now.
* A Zowe component or extension can use `manifest.yaml` to define how it interacts with Zowe and other components.
   * The component or extension must define a `manifest.yaml` or `manifest.json` file to describe itself. The manifest allows you to define how to register on Zowe API ML Discovery, how to register under Zowe Desktop, and whether itâ€™s Java extension library for API ML, and so on.
   * Components can define their own `configs` in `manifest.yaml` which shows you how to customize this component and provides default values if they are not defined. This option is compatible with Zowe running in high availability mode.
* Introduced new data sets to better organize the contents.
   * Added `SZWEEXEC` to contain few utility tools.
   * You can customize your own PARMLIB, APF Authorized LOADLIB and APF-authorized ZIS plug-ins library. `CUST.JCLIB` is a data set where Zowe will store temporary JCLs.
* Use PARMLIB to configure Zowe.
  
  With traditional PARMLIB concatenation, system programmers can plan their Zowe rollout more like other z/OS products. Multiple YAML configurations will be concatenated and merged. JSON Schema is introduced to help on validating user customized configurations.

### Zowe API Mediation Layer

* Add missing tooltips to all onboarding options (#2194) ([5446fd5](https://github.com/zowe/api-layer/commit/5446fd5)), closes [#2194](https://github.com/zowe/api-layer/issues/2194)
* Discovery service can be configured to modify the service ID at registration time (#2229) ([63f6fde](https://github.com/zowe/api-layer/commit/63f6fde)), closes [#2229](https://github.com/zowe/api-layer/issues/2229)
* There is now the option to specify base packages for the extensions loader(#2081) ([9a4be5a](https://github.com/zowe/api-layer/commit/9a4be5a)), closes [#2081](https://github.com/zowe/api-layer/issues/2081)
* There is a new design of the logout panel in the Catalog dashboard (#2102) ([1382f24](https://github.com/zowe/api-layer/commit/1382f24)), closes [#2102](https://github.com/zowe/api-layer/issues/2102)
* There is now the option to change your password via the Catalog UI (#2035) ([139a231](https://github.com/zowe/api-layer/commit/139a231)), closes [#2035](https://github.com/zowe/api-layer/issues/2035)
* Migrated the onboarding wizard to the Material UI library. This replaces the Mineral UI framework with the Material UI usage in the wizard (#2004) ([2c595d5](https://github.com/zowe/api-layer/commit/2c595d5)), closes [#2004](https://github.com/zowe/api-layer/issues/2004)
* Migrated the dashboard to the Material UI library (#1959) ([0da7f15](https://github.com/zowe/api-layer/commit/0da7f15)), closes [#1959](https://github.com/zowe/api-layer/issues/1959)
* Migrated the detail page to the Material UI library (#1949) ([95da488](https://github.com/zowe/api-layer/commit/95da488)), closes [#1949](https://github.com/zowe/api-layer/issues/1949)
* Migrated Error components to the Material UI library (#1957) ([c60371d](https://github.com/zowe/api-layer/commit/c60371d)), closes [#1957](https://github.com/zowe/api-layer/issues/1957)
* Migrated the header and footer to the Material UI library (#1943) ([537fa34](https://github.com/zowe/api-layer/commit/537fa34)), closes [#1943](https://github.com/zowe/api-layer/issues/1943)
* Migrated the Login panel to the Material UI library (#1900) ([81ab2ed](https://github.com/zowe/api-layer/commit/81ab2ed)), closes [#1900](https://github.com/zowe/api-layer/issues/1900) 
* Made various improvements to the onboarding wizard (#1772) ([20dd70b](https://github.com/zowe/api-layer/commit/20dd70b)), closes [#1772](https://github.com/zowe/api-layer/issues/1772)

### Zowe Application Framework

Zowe V2 simplifies the installation and configuration. Reduced overhead and increased performance due to reduction in server count. Optimized networking and 64 bit ZSS.

* Consolidation of Web Explorer Servers: Explorer USS, MVS, and JES no longer have node servers (3 less servers), due to utilizing app-server for hosting. Consolidation of web explorer servers
* Jobs and Datasets APIs now disabled by default (2 less servers), and Explorers do not rely on them
* Replaced referrer security check with 'samesite' cookie option: No longer need to specify external hostname to pass security check
* Removed "loopback routing" in app-server: Resolves bugs around use of a loopback IP when running app-server
* Support specifying advanced app-server and zss config in `zowe.yaml`: Simplify/Unify app framework configuration by using 1 config file rather than 2 (`instance.env`, `server.json`)
* Contiguous default ports: App framework ports (formerly 85xx) now follow API ML ports (75xx)
* App-server bind to IP_ADDRESS by default: Instead of  `0.0.0.0`, app-server now uses same IP as rest of Zowe servers
* Consistent environment variable names: Standardize environment variable names around `ZWED_`, and `ZWES_` prefixes for consistency. Aliases to previous names
* Informative desktop login messages: Desktop login failures now print useful troubleshooting details about server communication issues
* ZSS 64 bit: ZSS 64 bit version now exists alongside prior 31-bit version. Better performance and higher memory limit. Now utilizes 64-bit cross-memory to ZIS
* New desktop library versions: Angular 6->12, Corejs 2->3, Typescript 2->4

### Zowe CLI

Zowe CLI contains the following enhancements and changes:

- Updated the version number of the Zowe-CLI executable.
- Added help for zowe daemon restart command.
- Changed type of encoding property on z/OSMF profile from number to string to support more values (e.g., "ISO8859-1").
- Added support for --record format on zowe zos-files download (data-set|all-members) and zowe zos-files upload (dir-to-pds|file-to-data-set|stdin-to-data-set) #539
- Added prompt for base profile host property to zowe config init. #1219
- Added a user message within 'daemon enable' and disable to open a new terminal when needed.
- Add the commands zowe daemon enable and zowe daemon disable. These commands enable end-users to set up daemon mode without having to download a separate executable and place it by hand into some directory.
- Refactored communication between Imperative daemon client and server. Previously the client only sent CLI arguments and the current working directory. Now it sends a JSON object that also includes environment variables and input piped from stdin. #1179
- Update a "show attributes" flag to be -a instead of --pa. --pa is a "hidden" alias.
- Renamed the platform-specific executable from zowex to zowe, so that existing zowe commands used from the command line or in scripts do not have to change when running in daemon mode.
- Automatically launch the background daemon when one is not running.
- The daemon no longer has its own visible window, making it much more daemon-like.
- An environment variable named ZOWE_USE_DAEMON can be set to "no" to prevent the use of the daemon. Commands are then passed to the traditional zowe-CLI command. Thus, you can temporarily use the traditional Zowe CLI command to correct some display limitations (like displaying colors).
- Added autoStore property to config JSON files which defaults to true. When this property is enabled and the CLI prompts you to enter connection info, the values you enter will be saved to disk (or credential vault if they are secure) for future use. zowe/zowe-cli#923
- Display the set of changes made by the 'zowe config auto-init' command.
- Added config update-schemas [--depth `<value>`] command. #1059
- Added config import command that imports team config files from a local path or web URL. #1083
- Added Help Doc examples for the zowe config group of commands. #1061
- Log in to API ML to obtain token value instead of prompting for it in config secure command.
- Flattened the default profiles structure created by the config init command.
- Added the config auto-init command, allowing users to automatically generate a configuration using information stored in conformant installed plugins and the API Mediation Layer.
- Added new "config" command group to manage config JSON files. This is intended to replace the profiles API, and makes it easier for users to create, share, and switch between profile configurations.
- Added daemon mode which runs a persistent background process "zowex" to improve CLI response time. The "zowex" binary can be downloaded from GitHub releases.
- Added support for secure credential storage without any plug-ins required. On Linux there are some software requirements for this feature which are listed here (INSERT LINK).
- Deprecated: The "profiles" command group for managing global profiles in "~/.zowe/profiles". Use the new "config" command group instead.

### Imperative CLI Framework

starte here
### Zowe Explorer

* Changes to settings keys - automated migration of settings when user opens Zowe Explorer v2: (includes documentation) (#PR 1450)
* Using Global Profile Configuration
* Changes Affecting Extenders

### Zowe Software Development Kits (SDKs)

#### Node.js SDK

## Bug fixes

### Zowe API Mediation Layer

* Caching service logging (#2222) ([5ff64d9](https://github.com/zowe/api-layer/commit/5ff64d9)), closes [#2222](https://github.com/zowe/api-layer/issues/2222)
* Upgrade Spring to version without vulnerability (#2252) ([f77fa1b](https://github.com/zowe/api-layer/commit/f77fa1b)), closes [#2252](https://github.com/zowe/api-layer/issues/2252)
* Use unique artifacts for gha (#2192) ([f8def8c](https://github.com/zowe/api-layer/commit/f8def8c)), closes [#2192](https://github.com/zowe/api-layer/issues/2192)
* Add x509 auth info to gw api doc (#2142) ([072ad23](https://github.com/zowe/api-layer/commit/072ad23)), closes [#2142](https://github.com/zowe/api-layer/issues/2142)
* Authorization provider set empty as default (#2107) ([aa77926](https://github.com/zowe/api-layer/commit/aa77926)), closes [#2107](https://github.com/zowe/api-layer/issues/2107)
* Change url for v2 and mark plugin as v2 in case very old apiml v1 copies don't support same url  ([6f4257a](https://github.com/zowe/api-layer/commit/6f4257a)), closes [#2022](https://github.com/zowe/api-layer/issues/2022)

### Zowe Application Framework

### Zowe CLI

Zowe CLI contains the following bug fixes:

- Fixed ProfileInfo API targeting default base profile instead of the operating layer's base profile. Imperative#791
- Updated the imperative version to consume ProfileInfo API updates and to remove the moment dependency.
- Updated zowe auth login apiml, zowe auth logout apiml and zowe config auto-init comamnds to use v2 APIML APIs #1339
- Allows the CLI to complete installation when there is invalid config JSON #1198
- Fixed Daemon Concurrency problems in Windows by introducing a lock file
- Fixed Keytar not present in top level dependencies when CLI is installed non-globally. #1314
- Fixed packaging of daemon binary for macOS.
- Fixed some optional dependencies missing from npm-shrinkwrap file.
- Fixed daemon binaries missing from package and Keytar binaries not found at install time.
- Included an npm-shrinkwrap file to lock-down all transitive dependencies.
- Fixed 'daemon disable' command to kill any running zowe daemon on Linux and Mac. #1270
- Fixed stdin data being corrupted when daemon server processes CLI command containing double-byte characters.
- Set executable attribute on zowe executable file on Linux and Mac.
- Fixed socket connection error on macOS after commands that run in daemon mode. #1192
- Fixed daemon failing to run in path that contains space in directory name. #1237
- Changed credentials to be stored securely by default for v1 profiles to be consistent with the experience for v2 profiles. #1128
- Eliminate the display of escape characters when colors are displayed while running in daemon mode. #938. Currently accomplished by not displaying colors in daemon mode.
- Command-line arguments that contain spaces no longer require extra quotes or escapes. #978
- Don't expose port that daemon server listens on (default port is 4000).

### Imperative CLI Framework

Imperative CLI Framework contains the fllowing bug fixes:

- Fixed ProfileInfo API targeting default base profile instead of the operating layer's base profile. #791
- Fixed missing osLoc information from ProfileInfo.getAllProfiles(). #771
- Fixed updateKnownProperty saving to the active layer instead of the layer of the desired profile.
- Fixed autoStore property not being merged properly between team config layers.
- Updated moment dependency.
- Fixed config set command not respecting the property type defined in the schema. #772
- Reworded potentially misleading output of config convert-profiles command mentioning obsolete plug-ins.
- Made --dry-run and --prompt options mutually exclusive on config init command.
- Added the ability to read option values from aliases. Enhanced backward compatibility with V1 profiles. #770
- Allowed ProfileCredentials.isSecured to be insecure on teamConfig based on existing secure fields. #762
- Fixed incorrect description for untyped profiles in team config files. zowe/zowe-cli#1303
- Reverted unintentional breaking change that prevented DefaultCredentialManager from finding Keytar outside of calling CLI's node_modules folder.
- Removed user-defined secure properties if getSecureValues: false. #738
- Removed strict requirement of IHandlerParameter from the ConfigAutoStore class by implementing helper methods.
- Allowed private loadSchema function to return the corresponding schema for a user config. #758
- Fixed a bug where the `<APP>`_EDITOR environment variable was not being respected in a graphical environment zowe/zowe-cli#1335
- Fixed AbstractRestClient returning compressed data in causeErrors property for streamed responses. #753
- Removed extra space in help text following option name #745.
- Fixed Ctrl+C (SIGINT) response to CLI prompts throwing an error rather than exiting silently.
- Fixed useful debugging information missing from error message when Keytar module fails to load.
- Fixed ZOWE_CLI_HOME environment variable not respected by team config in daemon mode. zowe/zowe-cli#1240
- Fixed inconsistent error message when invalid CLI command is run in daemon mode. zowe/zowe-cli#1081
- Fixed config auto-store may store secure properties in plain text if secure array is outside of subprofile in team config. #709
- Removed @internal methods from type declarations so they don't appear in IntelliSense. #679
- Made the ProfileInfo.initSessCfg method public for easier instantiation of classes that extend AbstractSession.
- Fixed daemon mode not loading secure properties in team config. zowe/zowe-cli#1232
- Fixed config import and config init behaving incorrectly when config JSON exists in higher level directory. zowe/zowe-cli#1218
- Fixed config import command not failing when positional argument "location" is missing.
- Improved error message when Keytar module fails to load. #27
- Changed credentials to be stored securely by default for v1 profiles to be consistent with the experience for v2 profiles. zowe/zowe-cli#1128
- Fix crashing issue related to reloading the config when --dcd option is specified #943 #1190
- All methods in the IHandlerParameters.profiles class. Use the ConfigProfiles API for team config instead.
- Updated the profiles list as soon as the plugin is installed.
- Export all Config related interfaces.
- Fixed secure credentials not being stored by the config auto-init command.
- Revert schema changes related to additionalProperties. Re-enable IntelliSense when editing zowe.config.json files
- Allow SCS to load new securely stored credentials. #984
- Fixed Config object not exported at top level. #543
- Fixed error when Imperative APIs are called and "config" property of ImperativeConfig is not initialized. #533

### Zowe Explorer


### Zowe Software Development Kits (SDKs)

#### Node.js SDK

## Changes to Zowe Conformance Criteria

You can find the V2 Conformance Criteria as follows.

- [V2 Zowe API Mediation Layer Conformance Criteria](https://ibm.box.com/s/rdb7zfkcxzzbiro4idat9o7xd0qig3mt)
- [V2 Zowe CLI Conformance Criteria](https://ibm.box.com/s/st4jkk6xmughrg8ngcefvgt7fczicrk7)
- [V2 Zowe Application Framework Conformance Criteria](https://ibm.box.com/s/1om2ruoi8g2c8cjsh976q9cpg2vfbgl3)
- [V2 Zowe Explorer Conformance Criteria](https://ibm.box.com/s/0yuz16hwo522jegrtkysn36hto20qg6l)


## Known issues and limitations