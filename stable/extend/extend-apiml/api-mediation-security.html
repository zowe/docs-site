<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Zowe API Mediation Layer Security | Zowe Docs</title>
    <meta name="description" content="Version 1.14.x LTS">
    <meta name="google-site-verification" content="FFi0biHTX9XKglMxt3n2NZkB-knrnPxIrgBXpIZqlzc">
    
    <link rel="preload" href="/stable/assets/css/0.styles.e0fc2344.css" as="style"><link rel="preload" href="/stable/assets/js/app.3b20375d.js" as="script"><link rel="preload" href="/stable/assets/js/7.e5c8bdb0.js" as="script"><link rel="preload" href="/stable/assets/js/3.704fe720.js" as="script"><link rel="preload" href="/stable/assets/js/55.ced31314.js" as="script"><link rel="prefetch" href="/stable/assets/js/10.4edc57f5.js"><link rel="prefetch" href="/stable/assets/js/100.56ba3465.js"><link rel="prefetch" href="/stable/assets/js/101.ad410b43.js"><link rel="prefetch" href="/stable/assets/js/102.806fc0a8.js"><link rel="prefetch" href="/stable/assets/js/103.e02fcae0.js"><link rel="prefetch" href="/stable/assets/js/104.dccef620.js"><link rel="prefetch" href="/stable/assets/js/105.4bdb6407.js"><link rel="prefetch" href="/stable/assets/js/106.7b47dbdd.js"><link rel="prefetch" href="/stable/assets/js/107.aab8f53e.js"><link rel="prefetch" href="/stable/assets/js/108.10dfbe5a.js"><link rel="prefetch" href="/stable/assets/js/109.bdfad67a.js"><link rel="prefetch" href="/stable/assets/js/11.fb4df827.js"><link rel="prefetch" href="/stable/assets/js/110.56165dd6.js"><link rel="prefetch" href="/stable/assets/js/111.f80ab575.js"><link rel="prefetch" href="/stable/assets/js/112.a63a0c35.js"><link rel="prefetch" href="/stable/assets/js/113.da6651f1.js"><link rel="prefetch" href="/stable/assets/js/114.37519354.js"><link rel="prefetch" href="/stable/assets/js/115.0039d0d1.js"><link rel="prefetch" href="/stable/assets/js/116.4d853b88.js"><link rel="prefetch" href="/stable/assets/js/117.404ec7e0.js"><link rel="prefetch" href="/stable/assets/js/118.0f6266ff.js"><link rel="prefetch" href="/stable/assets/js/119.c65e4411.js"><link rel="prefetch" href="/stable/assets/js/12.c3b82c61.js"><link rel="prefetch" href="/stable/assets/js/120.44316106.js"><link rel="prefetch" href="/stable/assets/js/121.31ac8354.js"><link rel="prefetch" href="/stable/assets/js/122.59fbcbca.js"><link rel="prefetch" href="/stable/assets/js/123.6d6c9727.js"><link rel="prefetch" href="/stable/assets/js/124.13a65fc3.js"><link rel="prefetch" href="/stable/assets/js/125.b90a9277.js"><link rel="prefetch" href="/stable/assets/js/126.e04fccdd.js"><link rel="prefetch" href="/stable/assets/js/127.461cb563.js"><link rel="prefetch" href="/stable/assets/js/128.cc763a16.js"><link rel="prefetch" href="/stable/assets/js/129.4af1c6d2.js"><link rel="prefetch" href="/stable/assets/js/13.8be68973.js"><link rel="prefetch" href="/stable/assets/js/130.c07b7d83.js"><link rel="prefetch" href="/stable/assets/js/131.d0d5e5e0.js"><link rel="prefetch" href="/stable/assets/js/132.1a840c48.js"><link rel="prefetch" href="/stable/assets/js/133.26b499df.js"><link rel="prefetch" href="/stable/assets/js/134.c23d6e0f.js"><link rel="prefetch" href="/stable/assets/js/135.4b0c7870.js"><link rel="prefetch" href="/stable/assets/js/136.1db41182.js"><link rel="prefetch" href="/stable/assets/js/137.40cde256.js"><link rel="prefetch" href="/stable/assets/js/138.1cec2b82.js"><link rel="prefetch" href="/stable/assets/js/139.26ee6af4.js"><link rel="prefetch" href="/stable/assets/js/14.d938c477.js"><link rel="prefetch" href="/stable/assets/js/140.568a94ae.js"><link rel="prefetch" href="/stable/assets/js/141.f3fc2e2e.js"><link rel="prefetch" href="/stable/assets/js/15.b55081a4.js"><link rel="prefetch" href="/stable/assets/js/16.b9038c7d.js"><link rel="prefetch" href="/stable/assets/js/17.5d5f8d34.js"><link rel="prefetch" href="/stable/assets/js/18.a5425721.js"><link rel="prefetch" href="/stable/assets/js/19.05e526d1.js"><link rel="prefetch" href="/stable/assets/js/20.b20ebf0b.js"><link rel="prefetch" href="/stable/assets/js/21.50980e95.js"><link rel="prefetch" href="/stable/assets/js/22.e36646ca.js"><link rel="prefetch" href="/stable/assets/js/23.0d81b5cb.js"><link rel="prefetch" href="/stable/assets/js/24.82d047fb.js"><link rel="prefetch" href="/stable/assets/js/25.6b60979a.js"><link rel="prefetch" href="/stable/assets/js/26.b0a02857.js"><link rel="prefetch" href="/stable/assets/js/27.575fcebd.js"><link rel="prefetch" href="/stable/assets/js/28.0f8cc3a3.js"><link rel="prefetch" href="/stable/assets/js/29.0f11780c.js"><link rel="prefetch" href="/stable/assets/js/30.aed4e063.js"><link rel="prefetch" href="/stable/assets/js/31.e9c1d0ef.js"><link rel="prefetch" href="/stable/assets/js/32.c7f6dbf6.js"><link rel="prefetch" href="/stable/assets/js/33.a9545424.js"><link rel="prefetch" href="/stable/assets/js/34.5e02556a.js"><link rel="prefetch" href="/stable/assets/js/35.d5656244.js"><link rel="prefetch" href="/stable/assets/js/36.46fdd4cd.js"><link rel="prefetch" href="/stable/assets/js/37.af2818e8.js"><link rel="prefetch" href="/stable/assets/js/38.4c66cd8b.js"><link rel="prefetch" href="/stable/assets/js/39.4833b101.js"><link rel="prefetch" href="/stable/assets/js/4.f3be6380.js"><link rel="prefetch" href="/stable/assets/js/40.9d60df9e.js"><link rel="prefetch" href="/stable/assets/js/41.407b0e23.js"><link rel="prefetch" href="/stable/assets/js/42.206eb617.js"><link rel="prefetch" href="/stable/assets/js/43.3639477b.js"><link rel="prefetch" href="/stable/assets/js/44.c1060fc1.js"><link rel="prefetch" href="/stable/assets/js/45.120af886.js"><link rel="prefetch" href="/stable/assets/js/46.47d364f0.js"><link rel="prefetch" href="/stable/assets/js/47.db7f2aec.js"><link rel="prefetch" href="/stable/assets/js/48.850c1949.js"><link rel="prefetch" href="/stable/assets/js/49.9ab40e87.js"><link rel="prefetch" href="/stable/assets/js/5.57bdd090.js"><link rel="prefetch" href="/stable/assets/js/50.c646c85f.js"><link rel="prefetch" href="/stable/assets/js/51.56f9e30a.js"><link rel="prefetch" href="/stable/assets/js/52.8101442e.js"><link rel="prefetch" href="/stable/assets/js/53.58d007a7.js"><link rel="prefetch" href="/stable/assets/js/54.5e99f3b9.js"><link rel="prefetch" href="/stable/assets/js/56.4a4a2901.js"><link rel="prefetch" href="/stable/assets/js/57.0cf5d216.js"><link rel="prefetch" href="/stable/assets/js/58.3b7b2a07.js"><link rel="prefetch" href="/stable/assets/js/59.698175c0.js"><link rel="prefetch" href="/stable/assets/js/6.d8e58c83.js"><link rel="prefetch" href="/stable/assets/js/60.7b1afb9d.js"><link rel="prefetch" href="/stable/assets/js/61.952bbe65.js"><link rel="prefetch" href="/stable/assets/js/62.7bfd8971.js"><link rel="prefetch" href="/stable/assets/js/63.03091474.js"><link rel="prefetch" href="/stable/assets/js/64.3385ddac.js"><link rel="prefetch" href="/stable/assets/js/65.02455463.js"><link rel="prefetch" href="/stable/assets/js/66.3e2884b8.js"><link rel="prefetch" href="/stable/assets/js/67.affc1aca.js"><link rel="prefetch" href="/stable/assets/js/68.580c8e8b.js"><link rel="prefetch" href="/stable/assets/js/69.c3218b72.js"><link rel="prefetch" href="/stable/assets/js/70.419bbe82.js"><link rel="prefetch" href="/stable/assets/js/71.070b9ff5.js"><link rel="prefetch" href="/stable/assets/js/72.4299d304.js"><link rel="prefetch" href="/stable/assets/js/73.47186d5d.js"><link rel="prefetch" href="/stable/assets/js/74.9e58abdf.js"><link rel="prefetch" href="/stable/assets/js/75.5184ffa1.js"><link rel="prefetch" href="/stable/assets/js/76.13a96027.js"><link rel="prefetch" href="/stable/assets/js/77.6bc27f8e.js"><link rel="prefetch" href="/stable/assets/js/78.ffd578d5.js"><link rel="prefetch" href="/stable/assets/js/79.40a8edd1.js"><link rel="prefetch" href="/stable/assets/js/8.d2079ac5.js"><link rel="prefetch" href="/stable/assets/js/80.caa866b0.js"><link rel="prefetch" href="/stable/assets/js/81.b19deb52.js"><link rel="prefetch" href="/stable/assets/js/82.3dfb2fec.js"><link rel="prefetch" href="/stable/assets/js/83.32e818e5.js"><link rel="prefetch" href="/stable/assets/js/84.7272c826.js"><link rel="prefetch" href="/stable/assets/js/85.c4b548d5.js"><link rel="prefetch" href="/stable/assets/js/86.f883cd3a.js"><link rel="prefetch" href="/stable/assets/js/87.97676389.js"><link rel="prefetch" href="/stable/assets/js/88.16c96241.js"><link rel="prefetch" href="/stable/assets/js/89.f8205315.js"><link rel="prefetch" href="/stable/assets/js/9.4c5dc16b.js"><link rel="prefetch" href="/stable/assets/js/90.b597913d.js"><link rel="prefetch" href="/stable/assets/js/91.6c64fdf1.js"><link rel="prefetch" href="/stable/assets/js/92.448983d3.js"><link rel="prefetch" href="/stable/assets/js/93.a46ad804.js"><link rel="prefetch" href="/stable/assets/js/94.5438fb44.js"><link rel="prefetch" href="/stable/assets/js/95.7977ef5a.js"><link rel="prefetch" href="/stable/assets/js/96.a424606d.js"><link rel="prefetch" href="/stable/assets/js/97.86325c29.js"><link rel="prefetch" href="/stable/assets/js/98.f78b2e3c.js"><link rel="prefetch" href="/stable/assets/js/99.3581fefd.js"><link rel="prefetch" href="/stable/assets/js/vendors~docsearch.c2c7e391.js">
    <link rel="stylesheet" href="/stable/assets/css/0.styles.e0fc2344.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/stable/" class="home-link router-link-active"><!----> <span class="site-name">Zowe Docs</span></a> <div class="site-description"></div> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/getting-started/overview.html" class="nav-link"><!----> <span>Zowe overview</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/zowe-architecture.html" class="nav-link"><!----> <span>Zowe architecture</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/summaryofchanges.html" class="nav-link"><!----> <span>Release notes</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/cli-getting-started.html" class="nav-link"><!----> <span>Zowe CLI quick start</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/freqaskques.html" class="nav-link"><!----> <span>Zowe FAQs</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/zowe-resources.html" class="nav-link"><!----> <span>Related resources</span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="User Guide" class="dropdown-title"><span class="title">User Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/user-guide/installandconfig.html" class="nav-link"><!----> <span>Planning and preparing the installation</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/install-zos.html" class="nav-link"><!----> <span>Installing Zowe z/OS components</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/cli-installcli.html" class="nav-link"><!----> <span>Installing Zowe CLI</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/mvd-configuration.html" class="nav-link"><!----> <span>Advanced Zowe configuration</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/zowe-getting-started-tutorial.html" class="nav-link"><!----> <span>Using Zowe</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/cli-extending.html" class="nav-link"><!----> <span>Zowe CLI extensions and plug-ins</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/ze-install.html" class="nav-link"><!----> <span>Zowe Explorer</span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Extending" class="dropdown-title"><span class="title">Extending</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/extend/extend-zowe-overview.html" class="nav-link"><!----> <span>Overview</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/extend-cli/cli-devTutorials.html" class="nav-link"><!----> <span>Developing for Zowe CLI</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/extend-apiml/onboard-overview.html" class="nav-link"><!----> <span>Developing for API Mediation Layer</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/extend-desktop/mvd-extendingzlux.html" class="nav-link"><!----> <span>Developing for Zowe Application Framework</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/lifecycling-with-zwesvstc.html" class="nav-link"><!----> <span>Lifecycling z/OS extensions</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/zowe-conformance-program.html" class="nav-link"><!----> <span>Zowe Conformance Program</span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Troubleshooting" class="dropdown-title"><span class="title">Troubleshooting</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/troubleshooting.html" class="nav-link"><!----> <span>Overview</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/troubleshoot-zos.html" class="nav-link"><!----> <span>z/OS component installation</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/troubleshoot-apiml.html" class="nav-link"><!----> <span>Zowe API Mediation Layer</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/app-framework/app-troubleshoot.html" class="nav-link"><!----> <span>Zowe Application Framework</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/troubleshoot-zos-services.html" class="nav-link"><!----> <span>Zowe z/OS Services</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/cli/troubleshoot-cli.html" class="nav-link"><!----> <span>Zowe CLI</span></a></li></ul></div></div><div class="nav-item can-hide-first"><div class="dropdown-wrapper"><button type="button" aria-label="Contributing" class="dropdown-title"><span class="title">Contributing</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/contribute/guidelines-code/categories.html" class="nav-link"><!----> <span>Code guidelines</span></a></li><li class="dropdown-item"><!----> <a href="/stable/contribute/guidelines-ui/ui.html" class="nav-link"><!----> <span>UI guidelines</span></a></li><li class="dropdown-item"><!----> <a href="/stable/contribute/contributing.html" class="nav-link"><!----> <span>Contributing to documentation</span></a></li></ul></div></div><div class="nav-item can-hide-first"><div class="dropdown-wrapper"><button type="button" aria-label="References" class="dropdown-title"><span class="title">References</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/#zowe-cli-command-reference-guide" class="nav-link"><!----> <span>Zowe CLI command reference</span></a></li><li class="dropdown-item"><!----> <a href="/stable/appendix/bill-of-materials.html" class="nav-link"><!----> <span>Bill of Materials</span></a></li><li class="dropdown-item"><!----> <a href="/stable/appendix/tpsr.html" class="nav-link"><!----> <span>Third-Party Software Requirements</span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Versions" class="dropdown-title"><span class="title">Versions</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/" class="nav-link">
  v1.14.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-13-x/" class="nav-link">
  v1.13.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-12-x/" class="nav-link">
  v1.12.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-11-x/" class="nav-link">
  v1.11.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-10-x/" class="nav-link">
  v1.10.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-9-x/" class="nav-link">
  v1.9.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-8-x/" class="nav-link">
  v1.8.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-7-x/" class="nav-link">
  v1.7.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-6-x/" class="nav-link">
  v1.6.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-5-x/" class="nav-link">
  v1.5.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-4-x/" class="nav-link">
  v1.4.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-3-x/" class="nav-link">
  v1.3.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-2-x/" class="nav-link">
  v1.2.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-1-x/" class="nav-link">
  v1.1.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-0-x/" class="nav-link">
  v1.0.x
</a></li></ul></div></div><div class="nav-item"><a href="https://zowe.org" target="_blank" rel="noopener noreferrer" class="nav-link external"><img src="/stable/assets/zowe-logo.png" title="Zowe.org" width="20" height="20" style="vertical-align:top;"> <span class="not-in-navbar">Zowe.org</span></a></div> <a href="https://github.com/zowe/docs-site" target="_blank" rel="noopener noreferrer" class="repo-link"><img src="/stable/assets/github-mark-32px.png" width="20" height="20" title="GitHub" style="vertical-align:top"> <span class="not-in-navbar">GitHub</span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div class="sidebar-section">Extending</div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/getting-started/overview.html" class="nav-link"><!----> <span>Zowe overview</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/zowe-architecture.html" class="nav-link"><!----> <span>Zowe architecture</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/summaryofchanges.html" class="nav-link"><!----> <span>Release notes</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/cli-getting-started.html" class="nav-link"><!----> <span>Zowe CLI quick start</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/freqaskques.html" class="nav-link"><!----> <span>Zowe FAQs</span></a></li><li class="dropdown-item"><!----> <a href="/stable/getting-started/zowe-resources.html" class="nav-link"><!----> <span>Related resources</span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="User Guide" class="dropdown-title"><span class="title">User Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/user-guide/installandconfig.html" class="nav-link"><!----> <span>Planning and preparing the installation</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/install-zos.html" class="nav-link"><!----> <span>Installing Zowe z/OS components</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/cli-installcli.html" class="nav-link"><!----> <span>Installing Zowe CLI</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/mvd-configuration.html" class="nav-link"><!----> <span>Advanced Zowe configuration</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/zowe-getting-started-tutorial.html" class="nav-link"><!----> <span>Using Zowe</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/cli-extending.html" class="nav-link"><!----> <span>Zowe CLI extensions and plug-ins</span></a></li><li class="dropdown-item"><!----> <a href="/stable/user-guide/ze-install.html" class="nav-link"><!----> <span>Zowe Explorer</span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Extending" class="dropdown-title"><span class="title">Extending</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/extend/extend-zowe-overview.html" class="nav-link"><!----> <span>Overview</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/extend-cli/cli-devTutorials.html" class="nav-link"><!----> <span>Developing for Zowe CLI</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/extend-apiml/onboard-overview.html" class="nav-link"><!----> <span>Developing for API Mediation Layer</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/extend-desktop/mvd-extendingzlux.html" class="nav-link"><!----> <span>Developing for Zowe Application Framework</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/lifecycling-with-zwesvstc.html" class="nav-link"><!----> <span>Lifecycling z/OS extensions</span></a></li><li class="dropdown-item"><!----> <a href="/stable/extend/zowe-conformance-program.html" class="nav-link"><!----> <span>Zowe Conformance Program</span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Troubleshooting" class="dropdown-title"><span class="title">Troubleshooting</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/troubleshooting.html" class="nav-link"><!----> <span>Overview</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/troubleshoot-zos.html" class="nav-link"><!----> <span>z/OS component installation</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/troubleshoot-apiml.html" class="nav-link"><!----> <span>Zowe API Mediation Layer</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/app-framework/app-troubleshoot.html" class="nav-link"><!----> <span>Zowe Application Framework</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/troubleshoot-zos-services.html" class="nav-link"><!----> <span>Zowe z/OS Services</span></a></li><li class="dropdown-item"><!----> <a href="/stable/troubleshoot/cli/troubleshoot-cli.html" class="nav-link"><!----> <span>Zowe CLI</span></a></li></ul></div></div><div class="nav-item can-hide-first"><div class="dropdown-wrapper"><button type="button" aria-label="Contributing" class="dropdown-title"><span class="title">Contributing</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/contribute/guidelines-code/categories.html" class="nav-link"><!----> <span>Code guidelines</span></a></li><li class="dropdown-item"><!----> <a href="/stable/contribute/guidelines-ui/ui.html" class="nav-link"><!----> <span>UI guidelines</span></a></li><li class="dropdown-item"><!----> <a href="/stable/contribute/contributing.html" class="nav-link"><!----> <span>Contributing to documentation</span></a></li></ul></div></div><div class="nav-item can-hide-first"><div class="dropdown-wrapper"><button type="button" aria-label="References" class="dropdown-title"><span class="title">References</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/#zowe-cli-command-reference-guide" class="nav-link"><!----> <span>Zowe CLI command reference</span></a></li><li class="dropdown-item"><!----> <a href="/stable/appendix/bill-of-materials.html" class="nav-link"><!----> <span>Bill of Materials</span></a></li><li class="dropdown-item"><!----> <a href="/stable/appendix/tpsr.html" class="nav-link"><!----> <span>Third-Party Software Requirements</span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Versions" class="dropdown-title"><span class="title">Versions</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stable/" class="nav-link">
  v1.14.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-13-x/" class="nav-link">
  v1.13.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-12-x/" class="nav-link">
  v1.12.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-11-x/" class="nav-link">
  v1.11.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-10-x/" class="nav-link">
  v1.10.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-9-x/" class="nav-link">
  v1.9.x LTS
</a></li><li class="dropdown-item"><!----> <a href="/v1-8-x/" class="nav-link">
  v1.8.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-7-x/" class="nav-link">
  v1.7.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-6-x/" class="nav-link">
  v1.6.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-5-x/" class="nav-link">
  v1.5.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-4-x/" class="nav-link">
  v1.4.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-3-x/" class="nav-link">
  v1.3.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-2-x/" class="nav-link">
  v1.2.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-1-x/" class="nav-link">
  v1.1.x
</a></li><li class="dropdown-item"><!----> <a href="/v1-0-x/" class="nav-link">
  v1.0.x
</a></li></ul></div></div><div class="nav-item"><a href="https://zowe.org" target="_blank" rel="noopener noreferrer" class="nav-link external"><img src="/stable/assets/zowe-logo.png" title="Zowe.org" width="20" height="20" style="vertical-align:top;"> <span class="not-in-navbar">Zowe.org</span></a></div> <a href="https://github.com/zowe/docs-site" target="_blank" rel="noopener noreferrer" class="repo-link"><img src="/stable/assets/github-mark-32px.png" width="20" height="20" title="GitHub" style="vertical-align:top"> <span class="not-in-navbar">GitHub</span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Overview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/stable/extend/extend-zowe-overview.html" class="sidebar-link">Extending Zowe</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Developing for Zowe CLI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Developing for API Mediation Layer</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/stable/extend/extend-apiml/onboard-overview.html" class="sidebar-link">Onboarding Overview</a></li><li><a href="/stable/extend/extend-apiml/onboard-plain-java-enabler.html" class="sidebar-link">Onboarding a REST API service with the Plain Java Enabler (PJE)</a></li><li><a href="/stable/extend/extend-apiml/onboard-plain-java-enabler-external-configuration.html" class="sidebar-link">API Mediation Layer onboarding configuration</a></li><li><a href="/stable/extend/extend-apiml/onboard-direct-eureka-call.html" class="sidebar-link">Onboarding a service with the Zowe API Meditation Layer without an onboarding enabler</a></li><li><a href="/stable/extend/extend-apiml/onboard-spring-boot-enabler.html" class="sidebar-link">Onboarding a Spring Boot based REST API Service</a></li><li><a href="/stable/extend/extend-apiml/onboard-static-definition.html" class="sidebar-link">Onboard a REST API without code changes required</a></li><li><a href="/stable/extend/extend-apiml/api-mediation-message-service.html" class="sidebar-link">API Mediation Layer Message Service Component</a></li><li><a href="/stable/extend/extend-apiml/api-mediation-security.html" class="active sidebar-link">Zowe API Mediation Layer Security</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#how-api-ml-transport-security-works" class="sidebar-link">How API ML transport security works</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#transport-layer-security" class="sidebar-link">Transport layer security</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#authentication" class="sidebar-link">Authentication</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#zowe-api-ml-services" class="sidebar-link">Zowe API ML services</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#zowe-api-ml-tls-requirements" class="sidebar-link">Zowe API ML TLS requirements</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#authentication-for-api-ml-services" class="sidebar-link">Authentication for API ML services</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#authorization" class="sidebar-link">Authorization</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#jwt-token" class="sidebar-link">JWT Token</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#z-osmf-json-web-tokens-support" class="sidebar-link">z/OSMF JSON Web Tokens Support</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#api-ml-truststore-and-keystore" class="sidebar-link">API ML truststore and keystore</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#api-ml-saf-keyring" class="sidebar-link">API ML SAF Keyring</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#discovery-service-authentication" class="sidebar-link">Discovery Service authentication</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#setting-ciphers-for-api-ml-services" class="sidebar-link">Setting ciphers for API ML services</a></li></ul></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#participating-in-zowe-api-ml-single-sign-on" class="sidebar-link">Participating in Zowe API ML Single-Sign-On</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#zowe-api-ml-client" class="sidebar-link">Zowe API ML client</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#api-service-accessed-via-zowe-api-ml" class="sidebar-link">API service accessed via Zowe API ML</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#existing-services-that-cannot-be-modified" class="sidebar-link">Existing services that cannot be modified</a></li></ul></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#zaas-client" class="sidebar-link">ZAAS Client</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#pre-requisites" class="sidebar-link">Pre-requisites</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#api-documentation" class="sidebar-link">API Documentation</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#getting-started-step-by-step-instructions" class="sidebar-link">Getting Started (Step by Step Instructions)</a></li></ul></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#certificate-management-in-zowe-api-mediation-layer" class="sidebar-link">Certificate management in Zowe API Mediation Layer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#running-on-localhost" class="sidebar-link">Running on localhost</a></li><li class="sidebar-sub-header"><a href="/stable/extend/extend-apiml/api-mediation-security.html#zowe-runtime-on-z-os" class="sidebar-link">Zowe runtime on z/OS</a></li></ul></li></ul></li><li><a href="/stable/extend/extend-apiml/api-mediation-routing.html" class="sidebar-link">API Mediation Layer routing</a></li><li><a href="/stable/extend/extend-apiml/api-mediation-passtickets.html" class="sidebar-link">Enabling PassTicket creation for API Services that Accept PassTickets</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Developing for Zowe Application Framework</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Lifecycling z/OS extensions</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/stable/extend/lifecycling-with-zwesvstc.html" class="sidebar-link">Zowe lifecycle</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Zowe Conformance Program</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/stable/extend/zowe-conformance-program.html" class="sidebar-link">Zowe Conformance Program</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="zowe-api-mediation-layer-security"><a href="#zowe-api-mediation-layer-security" class="header-anchor">#</a> Zowe API Mediation Layer Security</h1> <ul><li><a href="#zowe-api-mediation-layer-security">Zowe API Mediation Layer Security</a> <ul><li><a href="#how-api-ml-transport-security-works">How API ML transport security works</a> <ul><li><a href="#transport-layer-security">Transport layer security</a></li> <li><a href="#authentication">Authentication</a></li> <li><a href="#zowe-api-ml-services">Zowe API ML services</a></li> <li><a href="#zowe-api-ml-tls-requirements">Zowe API ML TLS requirements</a></li> <li><a href="#authentication-for-api-ml-services">Authentication for API ML services</a> <ul><li><a href="#authentication-endpoints">Authentication endpoints</a></li> <li><a href="#authentication-providers">Authentication providers</a> <ul><li><a href="#z-osmf-authentication-provider">z/OSMF Authentication Provider</a></li> <li><a href="#dummy-authentication-provider">Dummy Authentication Provider</a></li></ul></li></ul></li> <li><a href="#authorization">Authorization</a></li> <li><a href="#jwt-token">JWT Token</a></li> <li><a href="#z-osmf-json-web-tokens-support">z/OSMF JSON Web Tokens Support</a></li> <li><a href="#api-ml-truststore-and-keystore">API ML truststore and keystore</a></li> <li><a href="#api-ml-saf-keyring">API ML SAF Keyring</a></li> <li><a href="#discovery-service-authentication">Discovery Service authentication</a></li> <li><a href="#setting-ciphers-for-api-ml-services">Setting ciphers for API ML services</a></li></ul></li> <li><a href="#participating-in-zowe-api-ml-single-sign-on">Participating in Zowe API ML Single-Sign-On</a> <ul><li><a href="#zowe-api-ml-client">Zowe API ML client</a></li> <li><a href="#api-service-accessed-via-zowe-api-ml">API service accessed via Zowe API ML</a></li> <li><a href="#existing-services-that-cannot-be-modified">Existing services that cannot be modified</a></li></ul></li> <li><a href="#zaas-client">ZAAS Client</a> <ul><li><a href="#pre-requisites">Pre-requisites</a></li> <li><a href="#api-documentation">API Documentation</a> <ul><li><a href="#obtain-a-jwt-token---login--">Obtain a JWT token (<code>login</code>)</a></li> <li><a href="#validate-and-get-details-from-the-token---query--">Validate and get details from the token (<code>query</code>)</a></li> <li><a href="#obtain-a-passticket---passticket--">Obtain a PassTicket (<code>passTicket</code>)</a></li></ul></li> <li><a href="#getting-started--step-by-step-instructions-">Getting Started (Step by Step Instructions)</a></li></ul></li> <li><a href="#certificate-management-in-zowe-api-mediation-layer">Certificate management in Zowe API Mediation Layer</a> <ul><li><a href="#running-on-localhost">Running on localhost</a> <ul><li><a href="#how-to-start-api-ml-on-localhost-with-full-https">How to start API ML on localhost with full HTTPS</a></li> <li><a href="#certificate-management-script">Certificate management script</a></li> <li><a href="#generate-certificates-for-localhost">Generate certificates for localhost</a></li> <li><a href="#generate-a-certificate-for-a-new-service-on-localhost">Generate a certificate for a new service on localhost</a></li> <li><a href="#add-a-service-with-an-existing-certificate-to-api-ml-on-localhost">Add a service with an existing certificate to API ML on localhost</a></li> <li><a href="#service-registration-to-discovery-service-on-localhost">Service registration to Discovery Service on localhost</a></li></ul></li> <li><a href="#zowe-runtime-on-z-os">Zowe runtime on z/OS</a> <ul><li><a href="#import-the-local-ca-certificate-to-your-browser">Import the local CA certificate to your browser</a></li> <li><a href="#generate-a-keystore-and-truststore-for-a-new-service-on-z-os">Generate a keystore and truststore for a new service on z/OS</a></li> <li><a href="#add-a-service-with-an-existing-certificate-to-api-ml-on-z-os">Add a service with an existing certificate to API ML on z/OS</a></li> <li><a href="#procedure-if-the-service-is-not-trusted">Procedure if the service is not trusted</a></li></ul></li></ul></li></ul></li></ul> <h2 id="how-api-ml-transport-security-works"><a href="#how-api-ml-transport-security-works" class="header-anchor">#</a> How API ML transport security works</h2> <p>Security within the API Mediation Layer (API ML) is performed on several levels. This article describes how API ML uses Transport Layer Security (TLS). As a system administrator or API developer, use this guide to familiarize yourself with the following security concepts:</p> <h3 id="transport-layer-security"><a href="#transport-layer-security" class="header-anchor">#</a> Transport layer security</h3> <p>Secure data during data-transport by using the TLS protocol for all connections to API Mediation Layer services. While it is possible to disable the TLS protocol for debugging purposes or other use-cases, the enabled TLS protocol is the default mode.</p> <h3 id="authentication"><a href="#authentication" class="header-anchor">#</a> Authentication</h3> <p>Authentication is the method of how an entity, whether it be a user (API Client) or an application (API Service), proves its true identity.</p> <p>API ML uses the following authentication methods:</p> <ul><li><p><strong>User ID and password</strong></p> <ul><li>The user ID and password are used to retrieve authentication tokens.</li> <li>Requests originate from a user.</li> <li>The user ID and password are validated by a z/OS security manager and
a token is issued that is then used to access the API service.</li></ul></li> <li><p><strong>TLS client certificates</strong></p> <ul><li>Certificates are for service-only requests.</li></ul></li></ul> <h3 id="zowe-api-ml-services"><a href="#zowe-api-ml-services" class="header-anchor">#</a> Zowe API ML services</h3> <p>The following range of service types apply to the Zoweâ„¢ API ML:</p> <ul><li><p><strong>Zowe API ML services</strong></p> <ul><li><p><strong>Gateway Service (GW)</strong>
The Gateway is the access point for API clients that require access to API services.
API services can be accessed through the Gateway by API Clients. The Gateway receives information about an API Service
from the Discovery Service.</p></li> <li><p><strong>Discovery Service (DS)</strong>
The Discovery Service collects information about API services and provides this information to the Gateway
and other services. API ML internal services are also registered to the Discovery Service.</p></li> <li><p><strong>API Catalog (AC)</strong>
The Catalog displays information about API services through a web UI. The Catalog receives information
about an API service from the Discovery Service.</p></li></ul></li> <li><p><strong>Authentication and Authorization Service (AAS)</strong></p> <p>AAS provides authentication and authorization functionality to check user access to resources on z/OS.
The API ML uses z/OSMF API for  authentication. For more information, see: <a href="https://github.com/zowe/api-layer/wiki/Zowe-Authentication-and-Authorization-Service" target="_blank" rel="noopener noreferrer">APIML wiki<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><strong>API Clients</strong></p> <p>External applications, users, or other API services that are accessing API services via the API Gateway</p></li> <li><p><strong>API Services</strong></p> <p>Applications that are accessed through the API Gateway. API services register themselves to the
Discovery Service and can access other services through the Gateway. If an API service is installed
in such a way that direct access is possible, API services can access other services without the Gateway.
When APIs access other services, they can also function as API clients.</p></li></ul> <h3 id="zowe-api-ml-tls-requirements"><a href="#zowe-api-ml-tls-requirements" class="header-anchor">#</a> Zowe API ML TLS requirements</h3> <p>The API ML TLS requires servers to provide HTTPS ports. Each of the API ML services has the following specific requirements:</p> <ul><li><p><strong>API Client</strong></p> <ul><li>The API Client is not a server</li> <li>Requires trust of the API Gateway</li> <li>Has a truststore or SAF keyring that contains certificates required to trust the Gateway</li></ul></li> <li><p><strong>Gateway Service</strong></p> <ul><li>Provides an HTTPS port</li> <li>Has a keystore or SAF keyring with a server certificate
<ul><li>The certificate needs to be trusted by API Clients</li> <li>This certificate should be trusted by web browsers because the API Gateway can be used to display web UIs</li></ul></li> <li>Has a truststore or SAF keyring that contains certificates needed to trust API Services</li></ul></li> <li><p><strong>API Catalog</strong></p> <ul><li>Provides an HTTPS port</li> <li>Has a keystore or SAF keyring with a server certificate
<ul><li>The certificate needs to be trusted by the API Gateway</li> <li>This certificate does not need to be trusted by anyone else</li></ul></li></ul></li> <li><p><strong>Discovery Service</strong></p> <ul><li>Provides an HTTPS port</li> <li>Has a keystore or SAF keyring with a server certificate</li> <li>Has a truststore or SAF keyring that contains certificates needed to trust API services</li></ul></li> <li><p><strong>API Service</strong></p> <ul><li>Provides an HTTPS port</li> <li>Has a keystore or SAF keyring with a server and client certificate
<ul><li>The server certificate needs to be trusted by the Gateway</li> <li>The client certificate needs to be trusted by the Discovery Service</li> <li>The client and server certificates can be the same</li> <li>These certificates do not need to be trusted by anyone else</li></ul></li> <li>Has a truststore or SAF keyring that contains one or more certificates that are required to trust the Gateway and Discovery Service</li></ul></li></ul> <h3 id="authentication-for-api-ml-services"><a href="#authentication-for-api-ml-services" class="header-anchor">#</a> Authentication for API ML services</h3> <ul><li><p><strong>API Gateway</strong></p> <ul><li>API Gateway handles authentication.</li> <li>There are two authentication endpoints that allow to authenticate the resource by providers</li> <li>Diagnostic endpoints <code>/application/**</code> in API Gateway are protected by basic authentication or Zowe JWT token.</li></ul></li> <li><p><strong>API Catalog</strong></p> <ul><li>API Catalog is accessed by users and requires protection by a login</li> <li>Protected access is performed by the Authentication and Authorization Service</li></ul></li> <li><p><strong>Discovery Service</strong></p> <ul><li>Discovery Service is accessed by API Services</li> <li>This access (reading information and registration) requires protection needs by a client certificate</li> <li>(Optional) Access can be granted to users (administrators)</li> <li>Diagnostic endpoints <code>/application/**</code> in Discovery Service are protected by basic authentication or Zowe JWT token.</li></ul></li> <li><p><strong>API Services</strong></p> <ul><li>Authentication is service-dependent</li> <li>Recommended to use the Authentication and Authorization Service for authentication</li></ul></li></ul> <h4 id="authentication-endpoints"><a href="#authentication-endpoints" class="header-anchor">#</a> Authentication endpoints</h4> <p>The API Gateway contains two REST API authentication endpoints: <code>auth/login</code> and <code>auth/query</code>.</p> <p>The <code>/login</code> endpoint authenticates mainframe user credentials and returns an authentication token. The login request requires user credentials though one of the following methods:</p> <ul><li>Basic access authentication</li> <li>JSON with user credentials</li></ul> <p>When authentication is successful the response to the request is an empty body and a token is contained in a secure <code>HttpOnly</code> cookie named <code>apimlAuthenticationToken</code>. When authentication fails, a user gets a 401 status code.</p> <p>The <code>/query</code> endpoint validates the token and retrieves the information associated with the token.
The query request requires the token through one of the following methods:</p> <ul><li>A cookie named <code>apimlAuthenticationToken</code></li> <li>Bearer authentication</li></ul> <p>When authentication is successful the response to the request is a JSON object which contains information associated with the token. When authentication fails, a user gets a 401 status code.</p> <p>The <code>/ticket</code> endpoint generates a PassTicket for the user associated with a token.</p> <p>This endpoint is protected by a client certificate.
The ticket request requires the token in one of the following formats:</p> <ul><li>Cookie named apimlAuthenticationToken.</li> <li>Bearer authentication</li></ul> <p>The request takes one parameter named <code>applicationName</code>, the name of the application for which the PassTicket should be generated. This parameter must be supplied.</p> <p>The response is a JSON object, which contains information associated with the ticket.</p> <p>For more details, see the OpenAPI documentation of the API Mediation Layer in the API Catalog.</p> <h4 id="authentication-providers"><a href="#authentication-providers" class="header-anchor">#</a> Authentication providers</h4> <p>API ML contains the following providers to handle authentication for the API Gateway:</p> <ul><li><code>z/OSMF Authentication Provider</code></li> <li><code>Dummy Authentication Provider</code></li></ul> <h5 id="z-osmf-authentication-provider"><a href="#z-osmf-authentication-provider" class="header-anchor">#</a> z/OSMF Authentication Provider</h5> <p>The <code>z/OSMF Authentication Provider</code> allows API Gateway to authenticate with the z/OSMF service. The user needs z/OSMF access in order to authenticate.</p> <p>Use the following properties of API Gateway to enable the <code>z/OSMF Authentication Provider</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>apiml.security.auth.provider: zosmf
apiml.security.auth.zosmfServiceId: zosmf  # Replace me with the correct z/OSMF service id
</code></pre></div><h5 id="dummy-authentication-provider"><a href="#dummy-authentication-provider" class="header-anchor">#</a> Dummy Authentication Provider</h5> <p>The <code>Dummy Authentication Provider</code> implements simple authentication for development purpose using dummy credentials (username:  <code>user</code>, password <code>user</code>). The <code>Dummy Authentication Provider</code> allows API Gateway to run without authenticating with the z/OSMF service.</p> <p>Use the following property of API Gateway to enable the <code>Dummy Authentication Provider</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>apiml.security.auth.provider: dummy
</code></pre></div><h3 id="authorization"><a href="#authorization" class="header-anchor">#</a> Authorization</h3> <p>Authorization is a method used to determine access rights of an entity.</p> <p>In the API ML, authorization is performed by the z/OS security manager (<a href="https://www.ca.com/us/products/ca-acf2.html" target="_blank" rel="noopener noreferrer">CA ACF2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.ibm.com/support/knowledgecenter/zosbasics/com.ibm.zos.zsecurity/zsecc_042.htm" target="_blank" rel="noopener noreferrer">IBM RACF<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.ca.com/us/products/ca-top-secret.html" target="_blank" rel="noopener noreferrer">CA Top Secret<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>). An authentication token is used as proof of valid authentication. The authorization checks, however, are always performed by the z/OS security manager.</p> <h3 id="jwt-token"><a href="#jwt-token" class="header-anchor">#</a> JWT Token</h3> <p>The JWT secret that signs the JWT Token is an asymmetric private key that is generated during Zowe keystore configuration. The JWT token is signed with the RS256 signature algorithm.</p> <p>You can find the JWT secret, alias <code>jwtsecret</code>, in the PKCS12 keystore that is stored in <code>${KEYSTORE_DIRECTORY}/localhost/localhost.keystore.p12</code>. The public key necessary to validate the JWT signature is read from the keystore.</p> <p>For easy access, you can find the public key in the <code>${KEYSTORE_DIRECTORY}/localhost/localhost.keystore.jwtsecret.pem</code> file.</p> <p>You can also use <code>/api/v1/gateway/auth/keys/public/all</code> endpoint to obtain all public keys that can be used to verify JWT tokens signature in a standard <a href="https://openid.net/specs/" target="_blank" rel="noopener noreferrer">JWK format<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="z-osmf-json-web-tokens-support"><a href="#z-osmf-json-web-tokens-support" class="header-anchor">#</a> z/OSMF JSON Web Tokens Support</h3> <p>Your z/OSMF instance can be enabled to support JWT tokens as described at <a href="https://www.ibm.com/support/knowledgecenter/SSLTBW_2.4.0/com.ibm.zos.v2r4.izua300/izuconfig_EnableJSONWebTokens.htm" target="_blank" rel="noopener noreferrer">Enabling JSON Web Token support<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
In this case, the Zowe API ML uses this JWT token and does not generate its own Zowe JWT token. All authentication APIs, such as <code>/api/v1/gateway/login</code> and <code>/api/v1/gateway/check</code> function in the same way as without z/OSMF JWT.
The <code>zowe-setup-certificates.sh</code> stores the z/OSMF JWT public key to the <code>localhost.keystore.jwtsecret.pem</code> that can be used for JWT signature validation.</p> <h3 id="api-ml-truststore-and-keystore"><a href="#api-ml-truststore-and-keystore" class="header-anchor">#</a> API ML truststore and keystore</h3> <p>A <em>keystore</em> is a repository of security certificates consisting of either authorization certificates or public key certificates with corresponding private keys (PK), used in TLS encryption. A <em>keystore</em> can be stored in Java specific format (JKS) or use the standard format (PKCS12). The Zowe API ML uses PKCS12 to enable the keystores to be used
by other technologies in Zowe (Node.js).</p> <h3 id="api-ml-saf-keyring"><a href="#api-ml-saf-keyring" class="header-anchor">#</a> API ML SAF Keyring</h3> <p>As an alternative to using a keystore and truststore, API ML can read certificates from a SAF keyring. The user running the API ML must have rights to access the keyring. From the java perspective, the keyring behaves as the <code>JCERACFKS</code> keystore. The path to the keyring is specified as <code>safkeyring:////user_id/key_ring_id</code>. The content of SAF keyring is equivalent to the combined contents of the keystore and the truststore.</p> <p><strong>Note:</strong> When using JCEFACFKS as the keystore type, ensure that you define the class to handle the RACF keyring using the <code>-D</code> options to specify the <code>java.protocol.handler.pkgs property</code>:</p> <pre><code>-Djava.protocol.handler.pkgs=com.ibm.crypto.provider
</code></pre> <p>The elements in the following list, which apply to the API ML SAF Keyring, have these corresponding characteristics:</p> <p><strong>The API ML local certificate authority (CA)</strong></p> <ul><li>The API ML local CA contains a local CA certificate and a private key that needs to be securely stored.</li> <li>The API ML local certificate authority is used to sign certificates of services.</li> <li>The API ML local CA certificate is trusted by API services and clients.</li></ul> <p><strong>The API ML keystore or API ML SAF Keyring</strong></p> <ul><li>Server certificate of the Gateway (with PK). This can be signed by the local CA or an external CA.</li> <li>Server certificate of the Discovery Service (with PK). This can be signed by the local CA.</li> <li>Server certificate of the Catalog (with PK). This can be signed by the local CA.</li> <li>Private asymmetric key for the JWT token, alias <code>jwtsecret</code>. The public key is exported to the <code>localhost.keystore.jwtsecret.cer</code> directory.</li> <li>The API ML keystore is used by API ML services.</li></ul> <p><strong>The API ML truststore or API ML SAF Keyring</strong></p> <ul><li>Local CA public certificate.</li> <li>External CA public certificate (optional).</li> <li>Can contain self-signed certificates of API Services that are not signed by the local or external CA.</li> <li>Used by API ML services.</li></ul> <p><strong>Zowe core services</strong></p> <ul><li>Services can use the same keystore and truststore or the same keyring as APIML for simpler installation and management.</li> <li>When using a keystore and truststore, services have to have rights to access and read them on the filesystem.</li> <li>When using a keyring, the user of the service must have authorization to read the keyring from the security system.</li> <li>Alternatively, services can have individual stores for higher security.</li></ul> <p><strong>API service keystore or SAF keyring</strong> (for each service)</p> <ul><li>The API service keystore contains a server and client certificate signed by the local CA.</li></ul> <p><strong>API service truststore or SAF keyring</strong> (for each service)</p> <ul><li>(Optional) The API service truststore contains a local CA and external CA certificates.</li></ul> <p><strong>Client certificates</strong></p> <ul><li>A client certificate is a certificate that is used for validation of the HTTPS client. The client certificate of a Discovery Service client can be the same certificate as the server certificate of the services which the Discovery Service client uses.</li></ul> <h3 id="discovery-service-authentication"><a href="#discovery-service-authentication" class="header-anchor">#</a> Discovery Service authentication</h3> <p>There are several authentication mechanisms, depending on the desired endpoint, as described by the following matrix:</p> <table><thead><tr><th>Endpoint</th> <th>Authentication method</th> <th>Note</th></tr></thead> <tbody><tr><td>UI (eureka homepage)</td> <td>basic auth(MF), token</td> <td>see note about mainframe authentication</td></tr> <tr><td>application/**</td> <td>basic auth(MF), token</td> <td>see note about mainframe authentication</td></tr> <tr><td>application/health, application/info</td> <td>none</td> <td></td></tr> <tr><td>eureka/**</td> <td>client certificate</td> <td>Allows for the other services to register without mainframe credentials or token. API ML's certificate can be used. It is stored in the <code>keystore/localhost/localhost.keystore.p12</code> keystore or in the SAF keyring. It is exported to .pem format for convenience. Any other certificate which is valid and trusted by Discovery service can be used.</td></tr> <tr><td>discovery/**</td> <td>certificate, basic auth(MF), token</td> <td>see note about mainframe authentication</td></tr></tbody></table> <p><strong>Note:</strong> Some endpoints are protected by mainframe authentication. The authentication function is provided by the API Gateway. This functionality is not available until the Gateway registers itself to the Discovery Service.</p> <p>Since the Discovery Service uses HTTPS, your client also requires verification of the validity of its certificate. Verification is performed by validating the client certificate against certificates stored in the truststore or SAF keyring.</p> <p>Some utilities including HTTPie require the certificate to be in PEM format. The exported certificate in .pem format is located here: <code>keystore/localhost/localhost.pem</code>.</p> <p>The following example shows the HTTPie command to access the Discovery Service endpoint for listing registered services and provides the client certificate:</p> <div class="language- extra-class"><pre class="language-text"><code>http --cert=keystore/localhost/localhost.pem --verify=false -j GET https://localhost:10011/eureka/apps/
</code></pre></div><h3 id="setting-ciphers-for-api-ml-services"><a href="#setting-ciphers-for-api-ml-services" class="header-anchor">#</a> Setting ciphers for API ML services</h3> <p>You can override ciphers that are used by the HTTPS servers in API ML services by configuring properties of the Gateway, Discovery Service, and API Catalog.</p> <p><strong>Note:</strong> You do not need to rebuild JAR files when you override the default values in shell scripts.</p> <p>The <em>application.yml</em> file contains the default value for each service, and can be found <a href="https://github.com/zowe/api-layer/blob/master/gateway-service/src/main/resources/application.yml" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The default configuration is packed in .jar files. On z/OS, you can override the default configuration in <code>$ZOWE_ROOT_DIR/components/api-mediation/bin/start.sh</code>.
Add the launch parameter of the shell script to set a cipher:</p> <div class="language- extra-class"><pre class="language-text"><code>-Dapiml.security.ciphers=&lt;cipher-list&gt;
</code></pre></div><p>On localhost, you can override the default configuration in <a href="https://github.com/zowe/api-layer/blob/master/config/local/gateway-service.yml" target="_blank" rel="noopener noreferrer">config/local/gateway-service.yml<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (including other YAML files for development purposes).</p> <p>The following list shows the default ciphers. API ML services use the following cipher order:</p> <p><strong>Note:</strong> Ensure that the version of Java you use is compatible with the default cipherset.</p> <div class="language- extra-class"><pre class="language-text"><code>   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
   TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,
   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
</code></pre></div><p>Only IANA ciphers names are supported. For more information, see <a href="https://wiki.mozilla.org/Security/Server_Side_TLS#Cipher_suites" target="_blank" rel="noopener noreferrer">Cipher Suites<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or <a href="https://testssl.net/openssl-iana.mapping.html" target="_blank" rel="noopener noreferrer">List of Ciphers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="participating-in-zowe-api-ml-single-sign-on"><a href="#participating-in-zowe-api-ml-single-sign-on" class="header-anchor">#</a> Participating in Zowe API ML Single-Sign-On</h2> <p>As Zowe extender, you can extend Zowe and participate in Zowe Single-Sign-On provided by Zowe API ML.</p> <p>The Zowe Single-Sign-On is based on a single authentication/identity token that identifies the z/OS user. This token needs to be trusted by extensions in order to be used. Only Zowe API ML and the ZAAS compoment (described above), can issue the authentication token based on valid z/OS credentials.</p> <p>In the current release of Zowe, only a single z/OS security domain can be used. The current Zowe release also allows for a single technology scope, whereby only a single-sign-on to Zowe Desktop is possible. As such, a second sign-on is necessary to different types of clients, such as Zowe CLI, or web applications outside of Zowe Desktop.</p> <p>This following section outlines the high-level steps necessary to achieve the sign-on.</p> <p>There are two main types of components that are used in Zowe SSO via API ML:</p> <ul><li><p>Zowe API ML client</p> <ul><li>This type of compoment is user-facing and can obtain credentials from the user through a user interface (web, CLI, desktop)</li> <li>The Zowe API ML client calls API services through the API ML</li> <li>An example of such clients are Zowe CLI or Zowe Desktop. Clients can be web or mobile applications</li></ul></li> <li><p>An API service accessed through Zowe API ML</p> <ul><li>A service that is registered to API ML and is accessed through the API Gateway</li></ul></li></ul> <p>In following sections, you will learn what is necessary to participate SSO for both types.</p> <h3 id="zowe-api-ml-client"><a href="#zowe-api-ml-client" class="header-anchor">#</a> Zowe API ML client</h3> <ul><li>Zowe API ML client needs to obtain an authentication token via the <code>/login</code> endpoint of ZAAS described above. This endpoint requires valid credentials.</li> <li>The client should not rely on the token format but use the ZAAS <code>/query</code> endpoint to validate the token and get information about it. This is useful when the API client has the token but does not store the associated data such as user ID.</li> <li>The API client needs to provide the authentication token to the API services in the form of a Secure HttpOnly cookie with the name <code>apimlAuthenticationToken</code> or in <code>Authorization: Bearer</code> HTTP header as described in the <a href="https://github.com/zowe/sample-spring-boot-api-service/blob/master/zowe-rest-api-sample-spring/docs/api-client-authentication.md#authenticated-request" target="_blank" rel="noopener noreferrer">Authenticated Request<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ul> <p><strong>Note:</strong> Plans for Zowe CLI to be an API ML client in the future, are desribed at <a href="https://medium.com/zowe/zowe-cli-token-authentication-mfa-and-sso-b88bca3efa35" target="_blank" rel="noopener noreferrer">Zowe CLI: Token Authentication, MFA, and SSO<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="api-service-accessed-via-zowe-api-ml"><a href="#api-service-accessed-via-zowe-api-ml" class="header-anchor">#</a> API service accessed via Zowe API ML</h3> <p>This section describes the requirements of a service to adopt the Zowe authentication token. Zowe will be able to support services that accept PassTickets in the future.</p> <ul><li>The API service must accept the authentication token to the API services in the form of a Secure HttpOnly cookie with the name <code>apimlAuthenticationToken</code> or in the <code>Authorization: Bearer</code> HTTP header as described in the <a href="https://github.com/zowe/sample-spring-boot-api-service/blob/master/zowe-rest-api-sample-spring/docs/api-client-authentication.md#authenticated-request" target="_blank" rel="noopener noreferrer">Authenticated Request<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li>The API service must validate the token and extract information about the user ID by calling <code>/query</code> endpoint of the ZAAS described above. The alternative is validate the signature of the JWT token. The format of the signature and location of the public key is described above. The alternative should be used only when the calling of <code>/query</code> endpoint is not feasible.</li> <li>The API service needs to trust the Zowe API gateway that hosts the ZAAS, it needs to have the certificate of the CA that signed the Zowe API Gateway in its truststore.</li></ul> <p>The REST API of the ZAAS can be easily called from a Java application using <a href="#zaas-client">ZAAS Client</a> described below.</p> <h3 id="existing-services-that-cannot-be-modified"><a href="#existing-services-that-cannot-be-modified" class="header-anchor">#</a> Existing services that cannot be modified</h3> <p>If you have a service that cannot be changed to adopt Zowe authentication token, they can still participate in Zowe Single-Sign-On via API ML.</p> <p>They need to accept PassTicket in the HTTP Authorization header.
See <a href="/stable/extend/extend-apiml/api-mediation-passtickets.html">Enabling PassTicket creation for API Services that Accept PassTickets</a> for more details.</p> <h2 id="zaas-client"><a href="#zaas-client" class="header-anchor">#</a> ZAAS Client</h2> <p>The ZAAS client is a plain Java library that provides authentication through a simple unified interface without the need
for detailed knowledge of the REST API calls presented in this section. The Client function has only a few dependencies including Apache HTTP Client, Lombok, and their associated dependencies. The client contains methods for retrieval of the JWT token, the PassTicket, and verification of JWT token information.</p> <h3 id="pre-requisites"><a href="#pre-requisites" class="header-anchor">#</a> Pre-requisites</h3> <ul><li>Java SDK version 1.8.</li> <li>An active instance of the API ML Gateway Service.</li> <li>A property file which defines the keystore or truststore certificates.</li></ul> <h3 id="api-documentation"><a href="#api-documentation" class="header-anchor">#</a> API Documentation</h3> <p>The plain java library provides the <code>ZaasClient</code> interface with following public methods:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ZaasClient</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> userId<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ZaasClientException</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> authorizationHeader<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ZaasClientException</span><span class="token punctuation">;</span>
    <span class="token class-name">ZaasToken</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ZaasClientException</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">passTicket</span><span class="token punctuation">(</span><span class="token class-name">String</span> jwtToken<span class="token punctuation">,</span> <span class="token class-name">String</span> applicationId<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ZaasClientException</span><span class="token punctuation">,</span> <span class="token class-name">ZaasConfigurationException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This Java code enables your application to add the following functions:</p> <ul><li><strong>Obtain a JWT token (<code>login</code>)</strong></li> <li><strong>Validate and get details from the token (<code>query</code>)</strong></li> <li><strong>Obtain a PassTicket (<code>passTicket</code>)</strong></li></ul> <h4 id="obtain-a-jwt-token-login"><a href="#obtain-a-jwt-token-login" class="header-anchor">#</a> Obtain a JWT token (<code>login</code>)</h4> <p>To integrate login, call one of the following methods for login in the <code>ZaasClient</code> interface:</p> <ul><li><p>If the user provides credentials in the request body, call the following method from your API:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> userId<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ZaasClientException</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>If the user provides credentials as Basic Auth, use the following method:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> authorizationHeader<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ZaasClientException</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <p>These methods return the JWT token as a String. This token can then be used to authenticate the user in subsequent APIs.</p> <p><strong>Note:</strong>
Both methods automatically use the truststore file to add a security layer, which requires configuration in the <code>ConfigProperties</code> class.</p> <h4 id="validate-and-get-details-from-the-token-query"><a href="#validate-and-get-details-from-the-token-query" class="header-anchor">#</a> Validate and get details from the token (<code>query</code>)</h4> <p>Use the <code>query</code> method to get the details embedded in the token. These details include creation time of the token, expiration time of the token, and the user who the token is issued to.</p> <p>To use this method, call the method from your API.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ZaasToken</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ZaasClientException</span><span class="token punctuation">;</span>
</code></pre></div><p>In return, you receive the <code>ZaasToken</code> Object in JSON format.</p> <p>This method automatically uses the truststore file to add a security layer, which you configured in the <code>ConfigProperties</code> class.</p> <h4 id="obtain-a-passticket-passticket"><a href="#obtain-a-passticket-passticket" class="header-anchor">#</a> Obtain a PassTicket (<code>passTicket</code>)</h4> <p>The <code>passTicket</code> method has an added layer of protection. To use this method, call the method of the interface and provide
a valid APPLID of the application and JWT token as an input.</p> <p>The APPLID is the name of the application (up to 8 characters) that is used by security products to differentiate certain security operations (like PassTickets) between applications.</p> <p>This method has an added layer of security, whereby you do not have to provide an input to the method since you already initialized the <code>ConfigProperties</code> class. As such, this method automatically fetches the truststore and keystore files as an input.</p> <p>In return, this method provides a valid pass ticket as a String to the authorized user.</p> <p><strong>Tip:</strong> For additional information about PassTickets in API ML see <a href="https://docs.zowe.org/stable/extend/extend-apiml/api-mediation-passtickets.html" target="_blank" rel="noopener noreferrer">Enabling PassTicket creation for API Services that Accept PassTickets<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="getting-started-step-by-step-instructions"><a href="#getting-started-step-by-step-instructions" class="header-anchor">#</a> Getting Started (Step by Step Instructions)</h3> <p>To use this library, use the procedure described in this section.</p> <p><strong>Follow these steps:</strong></p> <ol><li><p>Add <code>zaas-client</code> as a dependency in your project.</p> <p>Gradle:</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>dependencies <span class="token punctuation">{</span>
    compile <span class="token string">'org.zowe.apiml.sdk:zaas-client:{{version}}'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Maven:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.zowe.apiml.sdk:zaas-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>{{version}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>In your application, create your java class which will be used to create an instance of <code>ZaasClient</code>, which enables you to use its method to login, query, and to issue passTicket.</p></li> <li><p>To use <code>zaas-client</code>, provide a property file for configuration.</p> <p><strong>Tip:</strong> Check <code>org.zowe.apiml.zaasclient.config.ConfigProperites</code> to see which properties are required in the property file.</p> <p><strong>Configuration Properties:</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigProperties</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> apimlHost<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> apimlPort<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> apimlBaseUrl<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keyStoreType<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keyStorePath<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keyStorePassword<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> trustStoreType<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> trustStorePath<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> trustStorePassword<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Create an instance of <code>ZaasClient</code> in your class and provide the <code>configProperties</code> object.</p> <p><strong>Example:</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ZaasClient</span> zaasClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZaasClientHttps</span><span class="token punctuation">(</span><span class="token function">getConfigProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ol> <p>You can now use any method from <code>ZaasClient</code> in your class.</p> <p><strong>Example:</strong></p> <p>For login, use the following code snippet:</p> <div class="language-java extra-class"><pre class="language-java"><code>   <span class="token class-name">String</span> zaasClientToken <span class="token operator">=</span> zaasClient<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The following codeblock is an example of a <code>SampleZaasClientImplementation</code>.</p> <p><strong>Example:</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleZaasClientImplementation</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * This method is used to fetch token from zaasClient
     * @param username
     * @param password
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">ZaasClient</span> zaasClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZaasClientHttps</span><span class="token punctuation">(</span><span class="token function">getConfigProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> zaasClientToken <span class="token operator">=</span> zaasClient<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//Use this token  in subsequent calls</span>
            <span class="token keyword">return</span> zaasClientToken<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ZaasClientException</span> <span class="token operator">|</span> <span class="token class-name">ZaasConfigurationException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            exception<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">ConfigProperties</span> <span class="token function">getConfigProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Load the values for configuration properties</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="certificate-management-in-zowe-api-mediation-layer"><a href="#certificate-management-in-zowe-api-mediation-layer" class="header-anchor">#</a> Certificate management in Zowe API Mediation Layer</h2> <h3 id="running-on-localhost"><a href="#running-on-localhost" class="header-anchor">#</a> Running on localhost</h3> <h4 id="how-to-start-api-ml-on-localhost-with-full-https"><a href="#how-to-start-api-ml-on-localhost-with-full-https" class="header-anchor">#</a> How to start API ML on localhost with full HTTPS</h4> <p>The https://github.com/zowe/api-layer repository already contains pre-generated certificates that can be used to start API ML with HTTPS on your computer. The certificates are not trusted by your browser so you can either ignore the security warning or generate your own certificates and add them to the truststore of your browser or system.</p> <p>The certificates are described in more detail in the <a href="https://github.com/zowe/api-layer/blob/master/keystore/README.md" target="_blank" rel="noopener noreferrer">TLS Certificates for localhost<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p><strong>Note:</strong> When running on localhost, only the combination of using a keystore and truststore is supported.</p> <h4 id="certificate-management-script"><a href="#certificate-management-script" class="header-anchor">#</a> Certificate management script</h4> <p>Zowe API Mediation Layer provides a script that can be used on Windows, Mac, Linux, and z/OS
to generate a certificate and keystore for the local CA, API Mediation Layer, and services.</p> <p>This script is stored in <code>zowe/zowe-install-packaging</code> repository <a href="https://github.com/zowe/zowe-install-packaging/blob/master/bin/apiml_cm.sh" target="_blank" rel="noopener noreferrer">bin/apiml_cm.sh<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
It is a UNIX shell script that can be executed by Bash or z/OS Shell. For Windows, install Bash by going to the following link: <a href="http://cmder.net/" target="_blank" rel="noopener noreferrer">cmder<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h4 id="generate-certificates-for-localhost"><a href="#generate-certificates-for-localhost" class="header-anchor">#</a> Generate certificates for localhost</h4> <p><strong>Follow these steps:</strong></p> <ol><li>Clone the <code>zowe-install-packaging</code> repository to your local machine.</li> <li>Place the <code>bin/apiml_cm.sh</code> script intoto <code>scripts</code> directory in your API Mediation Layer repository folder</li> <li>Use the following script in the root of the <code>api-layer</code> repository to generate certificates for localhost:</li></ol> <p><code>scripts/apiml_cm.sh --action setup</code></p> <p>This script creates the certificates and keystore for the API Mediation Layer in your current workspace.</p> <h4 id="generate-a-certificate-for-a-new-service-on-localhost"><a href="#generate-a-certificate-for-a-new-service-on-localhost" class="header-anchor">#</a> Generate a certificate for a new service on localhost</h4> <p>To generate a certificate for a new service on localhost, see <a href="https://github.com/zowe/api-layer/blob/master/keystore/README.md#generating-certificate-for-a-new-service-on-localhost" target="_blank" rel="noopener noreferrer">Generating certificate for a new service on localhost<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h4 id="add-a-service-with-an-existing-certificate-to-api-ml-on-localhost"><a href="#add-a-service-with-an-existing-certificate-to-api-ml-on-localhost" class="header-anchor">#</a> Add a service with an existing certificate to API ML on localhost</h4> <p>For more information about adding a service with an existing certificate to API ML on localhost, see <a href="https://github.com/zowe/api-layer/blob/master/keystore/README.md#trust-certificates-of-other-services" target="_blank" rel="noopener noreferrer">Trust certificates of other services<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h4 id="service-registration-to-discovery-service-on-localhost"><a href="#service-registration-to-discovery-service-on-localhost" class="header-anchor">#</a> Service registration to Discovery Service on localhost</h4> <p>To register a new service to the Discovery Service using HTTPS, provide a valid client certificate that is trusted by the Discovery Service.</p> <h3 id="zowe-runtime-on-z-os"><a href="#zowe-runtime-on-z-os" class="header-anchor">#</a> Zowe runtime on z/OS</h3> <p>Certificates for the API ML local CA and API ML service are managed by installing the Zowe runtime on z/OS. Follow the instructions in <a href="/stable/user-guide/install-zos.html">Installing the Zowe runtime on z/OS</a>.</p> <p>There are two ways of setting up certificates on a z/OS machine.</p> <ul><li>certificates in SAF keyring</li> <li>certificates in UNIX files (keystore and truststore)</li></ul> <p>The <a href="/stable/user-guide/configure-certificates.html#configuring-zowe-certificates">Configuring Zowe certificates</a> contains instructions about how to set up certificates during installation. Follow the related section below, according to your choice during installation.</p> <h4 id="import-the-local-ca-certificate-to-your-browser"><a href="#import-the-local-ca-certificate-to-your-browser" class="header-anchor">#</a> Import the local CA certificate to your browser</h4> <p>Trust in the API ML server is a necessary precondition for secure communication between Browser or API Client application. Ensure this trust through the installation of a Certificate Authority (CA) public certificate. By default, API ML creates a local CA. Import the CA public certificate to the truststore for REST API clients and to your browser. You can also import the certificate to your root certificate store.</p> <p><strong>Notes:</strong></p> <ul><li>The public certificate in the <a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" target="_blank" rel="noopener noreferrer">PEM format<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is stored at <code>$KEYSTORE_DIRECTORY/local_ca/localca.cer</code> where <code>$KEYSTORE_DIRECTORY</code> is defined in a customized <code>$ZOWE_ROOT_DIR/bin/zowe-setup-certificates.env</code> file during the installation step that generates Zowe certificates. The certificate is stored in UTF-8 encoding so you need to transfer it as a binary file. Since this is the certificate to be trusted by your browser, it is recommended to use a secure connection for transfer.</li></ul> <p><strong>Follow these steps:</strong></p> <ol><li><p>Download the local CA certificate to your computer. Use one of the following methods to download the local CA certificate to your computer:</p> <ul><li><strong>Use <a href="https://github.com/zowe/zowe-cli#zowe-cli--" target="_blank" rel="noopener noreferrer">Zowe CLI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (Recommended)</strong>
Issue the following command:</li></ul> <p><code>zowe zos-files download uss-file --binary $KEYSTORE_DIRECTORY/local_ca/localca.cer</code></p> <ul><li><strong>Use <code>sftp</code></strong>
Issue the following command:</li></ul> <div class="language- extra-class"><pre class="language-text"><code>sftp &lt;system&gt;
get $KEYSTORE_DIRECTORY/local_ca/localca.cer
</code></pre></div><p>To verify that the file has been transferred correctly, open the file. The following heading and closing should appear:</p> <div class="language- extra-class"><pre class="language-text"><code>-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----
</code></pre></div></li> <li><p>Import the certificate to your root certificate store and trust it.</p> <ul><li><p><strong>For Windows</strong>, run the following command:</p> <p><code>certutil -enterprise -f -v -AddStore &quot;Root&quot; localca.cer</code></p> <p><strong>Note:</strong> Ensure that you open the terminal as <strong>administrator</strong>. This will install the certificate to the Trusted Root Certification Authorities.</p></li> <li><p><strong>For macOS</strong>, run the following command:</p> <p><code>$ sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain localca.cer</code></p></li> <li><p><strong>For Firefox</strong>, manually import your root certificate via the Firefox settings, or force Firefox to use the Windows truststore.</p> <p><strong>Note:</strong> Firefox uses its own certificate truststore.</p> <p>Create a new Javascript file firefox-windows-truststore.js at <code>C:\Program Files (x86)\Mozilla Firefox\defaults\pref</code> with the   following content:</p> <div class="language- extra-class"><pre class="language-text"><code>/* Enable experimental Windows truststore support */
pref(&quot;security.enterprise_roots.enabled&quot;, true);
</code></pre></div></li></ul></li></ol> <h4 id="generate-a-keystore-and-truststore-for-a-new-service-on-z-os"><a href="#generate-a-keystore-and-truststore-for-a-new-service-on-z-os" class="header-anchor">#</a> Generate a keystore and truststore for a new service on z/OS</h4> <p>You can generate a keystore and truststore for a new service by calling the <code>apiml_cm.sh</code> script in the directory with API Mediation Layer:</p> <div class="language- extra-class"><pre class="language-text"><code>cd $ZOWE_ROOT_DIR
bin/apiml_cm.sh --action new-service --service-alias &lt;alias&gt; --service-ext &lt;ext&gt; \
--service-keystore &lt;keystore_path&gt; --service-truststore &lt;truststore_path&gt; \
--service-dname &lt;dname&gt; --service-password &lt;password&gt; --service-validity &lt;days&gt; \
--local-ca-filename $KEYSTORE_DIRECTORY/local_ca/localca
</code></pre></div><p>The <code>service-alias</code> is an unique string to identify the key entry. All keystore entries (key and trusted certificate entries) are accessed via unique aliases. Since the keystore will have only one certificate, you can omit this parameter and use the default value <code>localhost</code>.</p> <p>The <code>service-keystore</code> is a repository of security certificates plus corresponding private keys. The <code>&lt;keystore_path&gt;</code> is the path excluding the extension to the keystore that will be generated. It can be an absolute path or a path relative to the current working directory. The key store is generated in PKCS12 format with <code>.p12</code> extension. It should be path in an existing directory where your service expects the keystore.</p> <p><strong>Example:</strong> <code>/opt/myservice/keystore/service.keystore</code>.</p> <p>The <code>service-truststore</code> contains certificates from other parties that you expect to communicate with, or from Certificate Authorities that you trust to identify other parties. The <code>&lt;truststore_path&gt;</code> is the path excluding the extension to the trust store that will be generated. It can be an absolute path or a path relative to the current working directory. The truststore is generated in PKCS12 format.</p> <p>The <code>service-ext</code> specifies the X.509 extension that should be the Subject Alternate Name (SAN). The SAN contains host names that are used to access the service. You need specify the same hostname that is used by the service during API Mediation Layer registration.</p> <p><strong>Example:</strong> <code>&quot;SAN=dns:localhost.localdomain,dns:localhost,ip:127.0.0.1&quot;</code></p> <p><strong>Note:</strong> For more information about SAN, see <em>SAN or SubjectAlternativeName</em> at <a href="https://www.ibm.com/support/knowledgecenter/en/SSYKE2_8.0.0/com.ibm.java.security.component.80.doc/security-component/keytoolDocs/commonoptions.html" target="_blank" rel="noopener noreferrer">Java Keytool - Common Options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>The <code>service-dname</code> is the X.509 Distinguished Name and is used to identify entities, such as those which are named by the subject and issuer (signer) fields of X.509 certificates.</p> <p><strong>Example:</strong> <code>&quot;CN=Zowe Service, OU=API Mediation Layer, O=Zowe Sample, L=Prague, S=Prague, C=CZ&quot;</code></p> <p>The <code>service-validity</code> is the number of days after until the certificate expires.</p> <p>The <code>service-password</code> is the keystore password. The purpose of the password is the integrity check. The access protection for the keystore and keystore need to be achieved by making them accessible only by the ZOVESVR user ID and the system administrator.</p> <p>The <code>local-ca-filename</code> is the path to the keystore that is used to sign your new certificate with the local CA private key. It should point to the <code>$KEYSTORE_DIRECTORY/local_ca/localca</code> where <code>$KEYSTORE_DIRECTORY</code> is defined in a customized <code>$ZOWE_ROOT_DIR/bin/zowe-setup-certificates.env</code> file during an installation step that generates Zowe certificates.</p> <h4 id="add-a-service-with-an-existing-certificate-to-api-ml-on-z-os"><a href="#add-a-service-with-an-existing-certificate-to-api-ml-on-z-os" class="header-anchor">#</a> Add a service with an existing certificate to API ML on z/OS</h4> <p><strong>Note:</strong> This procedure applies only to UNIX file keystore/truststore. For the SAF keyring option, we recommend to perform the actions manually using your security system commands.</p> <p>The API Mediation Layer requires validation of the certificate of each service that it accessed by the API Mediation Layer. The API Mediation Layer requires validation of the full certificate chain. Use one of the following methods:</p> <ul><li><p>Import the public certificate of the root CA that has signed the certificate of the service to the APIML truststore.</p></li> <li><p>Ensure that your service has its own certificate. If it was signed by intermediate CA, ensure that all intermediate CA certificates are contained in the service's keystore.</p> <p><strong>Note:</strong> If the service does not provide an intermediate CA certificates to the API ML, then validation fails. This can be circumvented by importing the intermediate CA certificates to the API ML truststore.</p></li></ul> <p>The following path is an example of importing a public certificate to the API ML truststore by calling in the directory with API Mediation Layer.</p> <p><strong>Example:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>cd $ZOWE_ROOT_DIR
bin/apiml_cm.sh --action trust --certificate &lt;path-to-certificate-in-PEM-format&gt; --alias &lt;alias&gt;
</code></pre></div><h4 id="procedure-if-the-service-is-not-trusted"><a href="#procedure-if-the-service-is-not-trusted" class="header-anchor">#</a> Procedure if the service is not trusted</h4> <p>If your service is not trusted, you may receive a response with the HTTP status code <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502" target="_blank" rel="noopener noreferrer">502 Bad Gateway<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and a JSON response in the standardized format for error messages. The following request is an example of when this errror response may occur.</p> <p><strong>Example:</strong></p> <p><code>http --verify=$KEYSTORE_DIRECTORY/local_ca/localca.cer GET https://&lt;gatewayHost&gt;:&lt;port&gt;&lt;/port&gt;/api/v1/&lt;untrustedService&gt;/greeting</code></p> <p>In this example, you will receive a similar response:</p> <div class="language- extra-class"><pre class="language-text"><code>    HTTP/1.1 502
    Content-Type: application/json;charset=UTF-8

    {
        &quot;messages&quot;: [
            {
                &quot;messageContent&quot;: &quot;The certificate of the service accessed by HTTPS using URI '/api/v1/&lt;untrustedService&gt;/greeting' is not trusted by the API Gateway: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target&quot;,
                &quot;messageKey&quot;: &quot;apiml.common.tlsError&quot;,
                &quot;messageNumber&quot;: &quot;AML0105&quot;,
                &quot;messageType&quot;: &quot;ERROR&quot;
            }
        ]
    }
</code></pre></div><p>The message has the key <code>apiml.common.tlsError</code>, and the message number <code>AML0105</code>, and content that explains details about the message.</p> <p>If you receive this message, import the certificate of your service or the CA that has signed it to the truststore of the API Mediation Layer as described above.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zowe/docs-site/edit/master/docs/extend/extend-apiml/api-mediation-security.md" target="_blank" rel="noopener noreferrer">Propose content change in GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/6/2020, 10:57:33 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/stable/extend/extend-apiml/api-mediation-message-service.html" class="prev">API Mediation Layer Message Service Component</a></span> <span class="next"><a href="/stable/extend/extend-apiml/api-mediation-routing.html">API Mediation Layer routing</a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/stable/assets/js/app.3b20375d.js" defer></script><script src="/stable/assets/js/7.e5c8bdb0.js" defer></script><script src="/stable/assets/js/3.704fe720.js" defer></script><script src="/stable/assets/js/55.ced31314.js" defer></script>
  </body>
</html>
